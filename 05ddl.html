
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Conceptos y actividades sobre">
      
      
      
        <link rel="canonical" href="https://aitor-medrano.github.io/bd/05ddl.html">
      
      
      
      
      <link rel="icon" href="images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Modelo Físico - SQL - Instrucciones DDL y DML - Bases de datos</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-QK8SL29WX3"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-QK8SL29WX3",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-QK8SL29WX3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Modelo Físico - SQL - Instrucciones DDL y DML - Bases de datos" >
      
        <meta  property="og:description"  content="Conceptos y actividades sobre" >
      
        <meta  property="og:image"  content="https://aitor-medrano.github.io/bd/assets/images/social/05ddl.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://aitor-medrano.github.io/bd/05ddl.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Modelo Físico - SQL - Instrucciones DDL y DML - Bases de datos" >
      
        <meta  name="twitter:description"  content="Conceptos y actividades sobre" >
      
        <meta  name="twitter:image"  content="https://aitor-medrano.github.io/bd/assets/images/social/05ddl.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modelo-fisico-sql-instrucciones-ddl-y-dml" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Bases de datos" class="md-header__button md-logo" aria-label="Bases de datos" data-md-component="logo">
      
  <img src="images/bd.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bases de datos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modelo Físico - SQL - Instrucciones DDL y DML
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Bases de datos" class="md-nav__button md-logo" aria-label="Bases de datos" data-md-component="logo">
      
  <img src="images/bd.png" alt="logo">

    </a>
    Bases de datos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="01intro.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.- Sistemas de almacenamiento
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="02er.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.- Diseño conceptual: Modelo Entidad/Relación
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="03mr.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.- Diseño lógico: Modelo Relacional
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="04mr-eer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.- Diseño lógico: Transformación
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="vocabulari.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <em>Vocabulari</em>
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="tags.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#propuesta-didactica" class="md-nav__link">
    <span class="md-ellipsis">
      Propuesta didáctica
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Propuesta didáctica">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#criterios-de-evaluacion" class="md-nav__link">
    <span class="md-ellipsis">
      Criterios de evaluación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contenidos" class="md-nav__link">
    <span class="md-ellipsis">
      Contenidos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programacion-de-aula-11h" class="md-nav__link">
    <span class="md-ellipsis">
      Programación de Aula (11h)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelo-fisico" class="md-nav__link">
    <span class="md-ellipsis">
      Modelo físico
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    <span class="md-ellipsis">
      SQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sintaxis" class="md-nav__link">
    <span class="md-ellipsis">
      Sintaxis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddl" class="md-nav__link">
    <span class="md-ellipsis">
      DDL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DDL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#puesta-en-marcha" class="md-nav__link">
    <span class="md-ellipsis">
      Puesta en marcha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bases-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Bases de datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenamiento" class="md-nav__link">
    <span class="md-ellipsis">
      Almacenamiento
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Almacenamiento">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motores-de-almacenamiento" class="md-nav__link">
    <span class="md-ellipsis">
      Motores de almacenamiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jerarquia-logica-de-una-bd" class="md-nav__link">
    <span class="md-ellipsis">
      Jerarquía lógica de una BD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#juegos-de-caracteres" class="md-nav__link">
    <span class="md-ellipsis">
      Juegos de caracteres
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tipos-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Tipos de datos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tipos de datos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creando-tipos-y-dominios" class="md-nav__link">
    <span class="md-ellipsis">
      Creando tipos y dominios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumeraciones" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeraciones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tablas" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tablas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clave-primaria" class="md-nav__link">
    <span class="md-ellipsis">
      Clave primaria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modificando-tablas" class="md-nav__link">
    <span class="md-ellipsis">
      Modificando tablas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eliminando-tablas" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminando tablas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restricciones" class="md-nav__link">
    <span class="md-ellipsis">
      Restricciones
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Restricciones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#claves-unicas" class="md-nav__link">
    <span class="md-ellipsis">
      Claves únicas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#claves-ajenas" class="md-nav__link">
    <span class="md-ellipsis">
      Claves ajenas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagacion" class="md-nav__link">
    <span class="md-ellipsis">
      Propagación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validaciones" class="md-nav__link">
    <span class="md-ellipsis">
      Validaciones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestionando" class="md-nav__link">
    <span class="md-ellipsis">
      Gestionando
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cargando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Cargando datos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cargando datos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejecutando-un-script" class="md-nav__link">
    <span class="md-ellipsis">
      Ejecutando un script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importando-una-base-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Importando una base de datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cargando-datos-desde-archivos" class="md-nav__link">
    <span class="md-ellipsis">
      Cargando datos desde archivos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dml" class="md-nav__link">
    <span class="md-ellipsis">
      DML
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DML">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modificaciones" class="md-nav__link">
    <span class="md-ellipsis">
      Modificaciones
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modificaciones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtrando" class="md-nav__link">
    <span class="md-ellipsis">
      Filtrando
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inserciones" class="md-nav__link">
    <span class="md-ellipsis">
      Inserciones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#borrados" class="md-nav__link">
    <span class="md-ellipsis">
      Borrados
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Borrados">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtrando_1" class="md-nav__link">
    <span class="md-ellipsis">
      Filtrando
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anomalias" class="md-nav__link">
    <span class="md-ellipsis">
      Anomalías
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reto-ii-creamos" class="md-nav__link">
    <span class="md-ellipsis">
      Reto II - Creamos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades" class="md-nav__link">
    <span class="md-ellipsis">
      Actividades
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <a href="tags.html#modelo-fisico" class="md-tag">Modelo Físico</a>
    
  
    
    
    
      <a href="tags.html#sql" class="md-tag">SQL</a>
    
  
    
    
    
      <a href="tags.html#sql-ddl" class="md-tag">SQL - DDL</a>
    
  
    
    
    
      <a href="tags.html#sql-dml" class="md-tag">SQL - DML</a>
    
  
    
    
    
      <a href="tags.html#ra2" class="md-tag">RA2</a>
    
  
    
    
    
      <a href="tags.html#ra4" class="md-tag">RA4</a>
    
  
</nav>



<h1 id="modelo-fisico-sql-instrucciones-ddl-y-dml">Modelo Físico: SQL - Instrucciones DDL y DML<a class="headerlink" href="#modelo-fisico-sql-instrucciones-ddl-y-dml" title="Permanent link">&para;</a></h1>
<h2 id="propuesta-didactica">Propuesta didáctica<a class="headerlink" href="#propuesta-didactica" title="Permanent link">&para;</a></h2>
<p>Una vez conocido el modelo relacional, en esta unidad vamos a comenzar a trabajar el RA2 "<strong>Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional</strong>", además de continuar con el RA5 "<strong>Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos</strong>".</p>
<h3 id="criterios-de-evaluacion">Criterios de evaluación<a class="headerlink" href="#criterios-de-evaluacion" title="Permanent link">&para;</a></h3>
<p>Respecto al RA2:</p>
<ul>
<li><strong><abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr></strong>: Se ha analizado el formato de almacenamiento de la información. </li>
<li><strong><abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr></strong>: Se han creado las tablas y las relaciones entre ellas. </li>
<li><strong><abbr title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr></strong>: Se han seleccionado los tipos de datos adecuados. </li>
<li><strong><abbr title="Se han definido los campos clave en las tablas.">CE2d</abbr></strong>: Se han definido los campos clave en las tablas. </li>
<li><strong><abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr></strong>: Se han implantado las restricciones reflejadas en el diseño lógico. </li>
</ul>
<p>Respecto al RA4:</p>
<ul>
<li><strong><abbr title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr></strong>: Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos. </li>
<li><strong><abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr></strong>: Se han insertado, borrado y actualizado datos en las tablas. </li>
</ul>
<h3 id="contenidos">Contenidos<a class="headerlink" href="#contenidos" title="Permanent link">&para;</a></h3>
<p>Bases de datos relacionales:</p>
<ul>
<li>Lenguaje de descripción de datos (DDL).</li>
</ul>
<p>Tratamiento de datos:</p>
<ul>
<li>Inserción, borrado y modificación de registros.</li>
<li>Integridad referencial.</li>
</ul>
<div class="admonition question">
<p class="admonition-title">Cuestionario inicial</p>
<ol>
<li>¿Cuál es el propósito de las sentencias DDL?</li>
<li>¿Y DML?</li>
<li>¿Para qué sirve el comando CREATE TABLE?</li>
<li>¿Qué diferencia CREATE TYPE de CREATE DOMAIN?</li>
<li>¿Puedo eliminas las tablas en cualquier orden mediante <code>DROP TABLE</code>?</li>
<li>¿Para qué sirve el comando <code>INSERT INTO</code>?</li>
<li>¿Qué sucede si omitimos el <code>WHERE</code> en un <code>DELETE FROM</code>?</li>
</ol>
</div>
<h3 id="programacion-de-aula-11h">Programación de Aula (11h)<a class="headerlink" href="#programacion-de-aula-11h" title="Permanent link">&para;</a></h3>
<p>Esta unidad es la quinta, con lo que se imparte en la primera evaluación, a finales del mes de noviembre, con una duración estimada de 11 sesiones lectivas:</p>
<table>
<thead>
<tr>
<th>Sesión</th>
<th>Contenidos</th>
<th>Actividades</th>
<th>Criterios trabajados</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><a href="#modelo-fisico">Modelo físico</a>. Puesta en marcha</td>
<td><a href="#AC501">AC501</a></td>
<td><abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr></td>
</tr>
<tr>
<td>2</td>
<td>DDL <a href="#bases-de-datos">Bases de datos</a> y <a href="#tipos-de-datos">tipos de datos</a></td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td><a href="#tablas">DDL Tablas</a></td>
<td><a href="#AC503">AC503</a></td>
<td><abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr> <abbr title="Se han definido los campos clave en las tablas.">CE2d</abbr></td>
</tr>
<tr>
<td>4</td>
<td><a href="#restricciones">Restricciones</a></td>
<td><a href="#AC504">AC504</a></td>
<td><abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr></td>
</tr>
<tr>
<td>5</td>
<td>Supuesto DDL</td>
<td><a href="#AC506">AC506</a></td>
<td><abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr></td>
</tr>
<tr>
<td>6</td>
<td>Cargando y exportando datos</td>
<td></td>
<td><abbr title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr></td>
</tr>
<tr>
<td>7</td>
<td>DML. Inserciones</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>DML. Actualizaciones</td>
<td></td>
<td></td>
</tr>
<tr>
<td>9</td>
<td>DML. Borrados</td>
<td></td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>Supuesto DML</td>
<td></td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>Reto - diseño físico</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Al finalizar esta unidad, comenzaremos un nuevo reto, centrado en el modelo físico, creando y cargando datos.</p>
<h2 id="modelo-fisico">Modelo físico<a class="headerlink" href="#modelo-fisico" title="Permanent link">&para;</a></h2>
<p>El modelo físico es la traducción del modelo lógico a un modelo interno, dando lugar a un esquema físico interpretable por un SGBD concreto, paso final del diseño de las bases de datos.</p>
<figure style="align: center;">
    <img src="images/02modelos.png" width="800" title="Del diseño a los modelos">
    <figcaption>Del diseño a los modelos</figcaption>
</figure>

<p>Para ello, transformaremos el modelo relacional al modelo físico utilizando un lenguaje específico de cada SGBD que nos permite definir los elementos, el cual se conoce como DDL (<em>Data Definition Language</em>).</p>
<h2 id="sql">SQL<a class="headerlink" href="#sql" title="Permanent link">&para;</a></h2>
<p>SQL (<em>sequel</em> en inglés) es la <em>lingua franca</em> para interactuar con las bases de datos relacionales. Es un lenguaje declarativo, donde lo importante es definir qué se quiere hacer, en lugar de cómo se va a hacer. </p>
<p>Su origen se se remonta a 1970 cuando <em>Edgar Frank Codd</em> publica el documento “<em>Un modelo relacional de datos para grandes bancos de datos compartidos</em>”, donde se definieron las bases del modelo relacional.</p>
<div class="admonition info">
<p class="admonition-title">Versiones</p>
<p>El lenguaje SQL ha ido evolucionando conforme lo han hecho los diferentes SGBD y tecnologías, desde el primer estándar en el archivo 1986 hasta la última versión de 2023:</p>
<ul>
<li>SQL-86: funcionalidad mínima para que un lenguaje se considere SQL, introduciendo las sentencia <code>SELECT</code>, <code>CREATE TABLE</code>, <code>INSERT</code>, ... y <code>JOIN</code>.</li>
<li>SQL-89: añade instrucciones para gestionar las claves ajenas (reglas de integridad referencial).</li>
<li>SQL-92: standard base. Introduce los tipos de datos para trabajar con fechas, como <code>DATE</code>, <code>TIME</code> y <code>TIMESTAMP</code>, la agregación de consultas con <code>GROUP BY</code> y sus operadores <code>COUNT</code> y <code>SUM</code>, así como la validación de los campos con <code>CHECK</code>.</li>
<li>SQL:1999 (SQL3): se añaden soporte para la programación orientada objetos y el uso de triggers y procedimientos almacenados mediante PL/SQL.</li>
<li>SQL:2003: añade características de XML y las funciones ventana, así como el uso de <code>SEQUENCE</code> para generar valores únicos.</li>
<li>SQL:2008: introduce soporte para datos temporales, la instrucción <code>MERGE</code> para combinar datos y mejoras en las expresiones de tabla comunes (con <code>WITH</code>).</li>
<li>SQL:2016: introduce soporte nativo para JSON y funciones para manejar datos geoespaciales.</li>
</ul>
</div>
<p>SQL se divide a su vez en cuatro "sublenguajes" respecto a la funcionalidad que ofrecen:</p>
<ul>
<li><strong>DDL</strong> (Data Definition Language): permite crear y manipular la estructura de una base de datos.</li>
<li><strong>DML</strong> (Data Manipulation Language): permite recuperar, almacenar, modificar, y eliminar datos de una BD</li>
<li><strong>DCL</strong> (<em>Data Control Language</em>): permite crear roles, permisos y usuarios, controlando el acceso a los elementos de nuestras bases de datos.</li>
<li><strong>TCL</strong> (<em>Transaction Control Language</em>): administra las modificaciones creadas con el DML.</li>
</ul>
<h3 id="sintaxis">Sintaxis<a class="headerlink" href="#sintaxis" title="Permanent link">&para;</a></h3>
<p>La sintaxis de SQL se define mediante instrucciones que tiene diferentes parámetros, unos opcionales, otros con diferentes valores, etc.. La nomenclatura que vamos a emplear al explicar la sintaxis de cada instrucción será la siguiente:</p>
<table>
<thead>
<tr>
<th>Símbolo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td>MAYÚSCULAS</td>
<td>Palabras reservadas (<em>keywords</em>) de SQL</td>
</tr>
<tr>
<td>minúsculas</td>
<td>variable que hay que sustituir por un elemento concreto</td>
</tr>
<tr>
<td><code>[]</code></td>
<td>opcional</td>
</tr>
<tr>
<td><code>|</code></td>
<td>separa opciones alternativas</td>
</tr>
<tr>
<td><code>[ | ]</code></td>
<td>se elige uno de los valores</td>
</tr>
<tr>
<td><code>{}</code></td>
<td>obliga a elegir uno de los valores</td>
</tr>
<tr>
<td><code>...</code></td>
<td>número variable de datos</td>
</tr>
</tbody>
</table>
<p>Así pues, si por ejemplo, la sintaxis de una instrucción es la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="k">ALL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">DISTINCT</span><span class="p">]</span><span class="w"> </span><span class="n">columna1</span><span class="w"> </span><span class="p">[,</span><span class="n">columna2</span><span class="p">,</span><span class="w"> </span><span class="n">columna3</span><span class="p">,.......]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">*</span>
<span class="linenos" data-linenos="2 "></span><span class="k">FROM</span><span class="w"> </span><span class="n">tabla1</span><span class="w"> </span><span class="p">[</span><span class="n">tabla2</span><span class="p">,</span><span class="w"> </span><span class="n">tabla3</span><span class="p">,</span><span class="w"> </span><span class="err">…</span><span class="p">.]</span>
<span class="linenos" data-linenos="3 "></span><span class="p">[</span><span class="k">WHERE</span><span class="w"> </span><span class="n">condición</span><span class="w"> </span><span class="p">]</span>
<span class="linenos" data-linenos="4 "></span><span class="p">[</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">expr1</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ASC</span><span class="p">]</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="n">expr2</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ASC</span><span class="p">]</span><span class="w"> </span><span class="p">....]</span>
</code></pre></div>
<div class="admonition info inline end">
<p class="admonition-title">Case sensitive</p>
<p>En entornos Windows no se distingue entre mayúsculas y minúsculas, pero en entornos Linux sí.</p>
</div>
<p>Destacar que las instrucciones finalizan con el signo de punto y coma (<code>;</code>) y que se emplea el doble guión (<code>--</code>) para introducir comentarios. Además, cualquier instrucción SQL puede ser partida por espacios o saltos de línea
antes de finalizar la instrucción, facilitando su lectura. Así pues, posibles sentencias que cumplen la sintaxis serían:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">-- Ejemplos de instrucciones SQL</span>
<span class="linenos" data-linenos="2 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">dni</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cliente</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">salario</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cliente</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">salario</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">salario</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">nombre</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">cliente</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">salario</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>
<h2 id="ddl">DDL<a class="headerlink" href="#ddl" title="Permanent link">&para;</a></h2>
<p>Al empezar esta unidad habíamos comentado que DDL es el lenguaje encargado de definir las estructuras de las bases de datos, esto es, permite la creación, modificación y eliminación de los objetos de la base de datos (metadatos), como, por ejemplo, las bases de datos, tablas, índices o vistas.</p>
<div class="admonition info inline end">
<p class="admonition-title">TRUNCATE</p>
<p>Mientras que con <code>DROP</code> podemos borrar una tabla, con <code>TRUNCATE</code> vaciaremos las tablas de contenido. Es por ello, que no se considera una operación DDL, sino más bien DML.</p>
</div>
<p>Para ello, utilizaremos principalmente tres tipos de sentencias:</p>
<ul>
<li><code>CREATE</code>: permite crear nuevas tablas, vistas e índices.</li>
<li><code>ALTER</code>: permite modificar las tablas agregando o eliminando campos, cambiar la definición de tipos, etc...</li>
<li><code>DROP</code>: empleado para eliminar las tablas y los índices.</li>
</ul>
<h3 id="puesta-en-marcha">Puesta en marcha<a class="headerlink" href="#puesta-en-marcha" title="Permanent link">&para;</a></h3>
<p>Para trabajar con un SGBD tenemos varias posibilidades. Una de ellas es mediante una solución ya desplegada en la nube, como veremos en la siguiente unidad. La segunda sería que lo instalásemos en nuestro sistema operativo mediante las instrucciones que ofrecen en sus páginas web, o bien utilizar uno de los paquetes "todo incluido" que ofrecen plataformas como <a href="https://bitnami.com/">Bitnami</a> (ya sea <a href="https://www.apachefriends.org/bitnami_for_xampp.html">XAMPP</a> u otro paquete). Nosotros nos hemos decantado por la tercera posibilidad, el uso de contenedores <a href="https://www.docker.com/">Docker</a> para aislar los servicios que utilicemos con lo que tengamos instalado en nuestros ordenadores. Por ello, en <a href="00entorno.html">Entornos</a> tiene toda la información necesaria tanto para poner en marcha <a href="00entorno.html#mariadb">MariaDB</a> como <a href="00entorno.html#postgresql">PostreSQL</a>.</p>
<p>Una vez instalados los SGBD y conectados a los mismos, ya sean mediante la consola o la interfaz gráfica, debemos saber que aunque el 90% de la sintaxis de SQL es común, cada SGBD tiene sus particularidades. Es por ello, que en este curso vamos a trabajar con <em>MariaDB</em> y <em>PostreSQL</em> de manera indistinta.</p>
<p>Recuerda que todas las instrucciones terminan en <code>;</code>y que vamos a dejar en MAYÚSCULAS las <em>keywords</em> para facilitar la lectura, aunque no es obligatorio escribirlas así.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">MariaDB</label><label for="__tabbed_1_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Primero nos conectamos al contenedor (el cual en el archivo <em>docker-compose</em> hemos llamado <code>mdb</code>):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>mdb<span class="w"> </span>bash
</code></pre></div>
<p>A continuación, con el cliente del SGBD, nos conectamos al servidor (al ser <code>localhost</code> no hace falta que lo indiquemos) pasándole el usuario (<code>-u nomusuario</code>) y la contraseña (<code>-pcontraseña</code>)`:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>mariadb<span class="w"> </span>-u<span class="w"> </span>s8a<span class="w"> </span>-ps8a<span class="w"> </span>pruebas
</code></pre></div>
<p>Y obtendremos información como que nos hemos conectado correctamente, y en la última línea muestra que ha conectado con la bd <code>pruebas</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="gp">root@e6dbf61ca4db:/# </span>mariadb<span class="w"> </span>-u<span class="w"> </span>s8a<span class="w"> </span>-ps8a<span class="w"> </span>pruebas
<span class="linenos" data-linenos=" 2 "></span><span class="go">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span>
<span class="linenos" data-linenos=" 3 "></span><span class="go">Your MariaDB connection id is 5</span>
<span class="linenos" data-linenos=" 4 "></span><span class="go">Server version: 11.4.2-MariaDB-ubu2404 mariadb.org binary distribution</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="go">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="go">Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="hll"><span class="linenos" data-linenos="10 "></span><span class="go">MariaDB [pruebas]&gt;</span>
</span></code></pre></div>
<p>Si quieres más información sobre como conectar con <em>MariaDB</em> y todos los parámetros disponibles, consulta la <a href="https://mariadb.com/kb/en/connecting-to-mariadb/">documentación oficial</a>.</p>
</div>
<div class="tabbed-block">
<p>Primero nos conectamos al contenedor (el cual en el archivo <em>docker-compose</em> hemos llamado <code>pg</code>):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>pg<span class="w"> </span>bash
</code></pre></div>
<p>A continuación, con el cliente del SGBD, nos conectamos al servidor (al ser <code>localhost</code> no hace falta que lo indiquemos) pasándole el usuario (<code>-U nomusuario</code>) y luego rellenando la contraseña (<code>s8a</code>):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>psql<span class="w"> </span>-U<span class="w"> </span>s8a<span class="w"> </span>pruebas
</code></pre></div>
<p>Obteniendo información de la versión instalada y en la última línea muestra que ha conectado con la bd <code>pruebas</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="gp">root@6475b31d89f4:/# </span>psql<span class="w"> </span>-U<span class="w"> </span>s8a<span class="w"> </span>pruebas
<span class="linenos" data-linenos="2 "></span><span class="go">psql (16.4 (Debian 16.4-1.pgdg120+1))</span>
<span class="linenos" data-linenos="3 "></span><span class="go">Type &quot;help&quot; for help.</span>
<span class="linenos" data-linenos="4 "></span>
<span class="hll"><span class="linenos" data-linenos="5 "></span><span class="go">pruebas=#</span>
</span></code></pre></div>
</div>
</div>
</div>
<hr />
<div class="admonition question">
<p class="admonition-title">Autoevaluación</p>
<p>En este momento deberías tener tanto <em>MariaDB</em> como <em>PostreSQL</em> instalado en local y ser capaz de conectarte desde la línea de comandos.</p>
<p>Una vez dentro, ejecuta los siguientes comandos y comprueba si entiendes qué realiza cada una de las siguientes sentencias:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">MariaDB</label><label for="__tabbed_2_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">SHOW</span><span class="w"> </span><span class="n">DATABASES</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="n">USE</span><span class="w"> </span><span class="n">mibd</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">SHOW</span><span class="w"> </span><span class="n">TABLES</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">DESCRIBE</span><span class="w"> </span><span class="n">mitabla</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="k">version</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">datname</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_database</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="err">\</span><span class="n">l</span>
<span class="linenos" data-linenos="4 "></span><span class="err">\</span><span class="n">dt</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<p>Comencemos con un caso muy sencillo, donde vamos a crear una tabla con un campo, insertar un registro y finalmente consultar la información recién almacenada:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ejemplo8a</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ejemplo8a</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Aitor Medrano&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="5 "></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ejemplo8a</span><span class="p">;</span>
</code></pre></div>
<p>Una vez conectados a nuestros SGBD y comprobado que podemos crear estructuras, insertar datos y consultarlos, vamos a profundizar en la definición de los esquemas relacionales.</p>
<h3 id="bases-de-datos">Bases de datos<a class="headerlink" href="#bases-de-datos" title="Permanent link">&para;</a></h3>
<p>El principal elemento en un SGBD es la base de datos.</p>
<p>Cuando nos conectamos indicaremos siempre a qué base de datos lo hacemos. De todos modos, siempre podemos consultar las bases de datos existentes:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">MariaDB</label><label for="__tabbed_3_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>En el caso de <em>MariaDB</em> usaremos el commando <a href="https://mariadb.com/kb/en/show-databases/"><code>SHOW DATABASES</code></a>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>MariaDB [pruebas]&gt; show databases;
<span class="linenos" data-linenos="2 "></span>+--------------------+
<span class="linenos" data-linenos="3 "></span>| Database           |
<span class="linenos" data-linenos="4 "></span>+--------------------+
<span class="linenos" data-linenos="5 "></span>| information_schema |
<span class="linenos" data-linenos="6 "></span>| pruebas            |
<span class="linenos" data-linenos="7 "></span>+--------------------+
<span class="linenos" data-linenos="8 "></span>2 rows in set (0.001 sec)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Si solo queremos el nombre de las bases de datos, podemos hacer una consulta a la tabla <code>pg_database</code> (la cual hace la función de diccionario de datos):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>pruebas=# SELECT datname FROM pg_database;
<span class="linenos" data-linenos="2 "></span>datname  
<span class="linenos" data-linenos="3 "></span>-----------
<span class="linenos" data-linenos="4 "></span>postgres
<span class="linenos" data-linenos="5 "></span>pruebas
<span class="linenos" data-linenos="6 "></span>template1
<span class="linenos" data-linenos="7 "></span>template0
<span class="linenos" data-linenos="8 "></span>(4 rows)
</code></pre></div>
<p>Si queremos toda la información, podemos hacer uso del comando <code>\l</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>pruebas=# \l
<span class="linenos" data-linenos=" 2 "></span>                                                List of databases
<span class="linenos" data-linenos=" 3 "></span>Name    | Owner | Encoding | Locale Provider |  Collate   |   Ctype    | ICU Locale | ICU Rules | Access privileges       
<span class="linenos" data-linenos=" 4 "></span>-----------+-------+----------+-----------------+------------+------------+------------+-----------+-------------------      
<span class="linenos" data-linenos=" 5 "></span>postgres  | s8a   | UTF8     | libc            | en_US.utf8 | en_US.utf8 |            |           |
<span class="linenos" data-linenos=" 6 "></span>pruebas   | s8a   | UTF8     | libc            | en_US.utf8 | en_US.utf8 |            |           |
<span class="linenos" data-linenos=" 7 "></span>template0 | s8a   | UTF8     | libc            | en_US.utf8 | en_US.utf8 |            |           | =c/s8a           +      
<span class="linenos" data-linenos=" 8 "></span>        |       |          |                 |            |            |            |           | s8a=CTc/s8a
<span class="linenos" data-linenos=" 9 "></span>template1 | s8a   | UTF8     | libc            | en_US.utf8 | en_US.utf8 |            |           | =c/s8a           +      
<span class="linenos" data-linenos="10 "></span>        |       |          |                 |            |            |            |           | s8a=CTc/s8a
<span class="linenos" data-linenos="11 "></span>(4 rows)
</code></pre></div>
</div>
</div>
</div>
<p>Para crear una base de datos, usaremos la sentencia <code>CREATE DATABASE</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">MariaDB</label><label for="__tabbed_4_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="p">[</span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">]</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="p">[</span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="p">]</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre></div>
<p>Por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">create</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">midb</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">create</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">severo</span><span class="p">;</span>
</code></pre></div>
<p>Más información en la <a href="https://mariadb.com/kb/en/create-database/">documentación oficial</a></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre></div>
<p>Por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">create</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">midb</span><span class="p">;</span>
</code></pre></div>
<p>Más información en la <a href="https://www.postgresql.org/docs/current/sql-createdatabase.html">documentación oficial</a></p>
</div>
</div>
</div>
<p>Si necesitamos borrarla, porque ya no la necesitamos, usaremos la sentencia <code>DROP DATABASE</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">MariaDB</label><label for="__tabbed_5_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DROP</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="p">[</span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="p">]</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre></div>
<p>Por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">drop</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">prueba</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">drop</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">severo</span><span class="p">;</span>
</code></pre></div>
<p>Más información en la <a href="https://mariadb.com/kb/en/drop-database/">documentación oficial</a></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DROP</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="p">[</span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="p">]</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre></div>
<p>Por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">drop</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">prueba</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">drop</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">severo</span><span class="p">;</span>
</code></pre></div>
<p>Más información en la <a href="https://www.postgresql.org/docs/current/sql-dropdatabase.html">documentación oficial</a></p>
</div>
</div>
</div>
<h3 id="almacenamiento">Almacenamiento<a class="headerlink" href="#almacenamiento" title="Permanent link">&para;</a></h3>
<p>A la hora de almacenar la información de una base de datos, tanto a nivel lógico como físico, necesitamos de diferentes elementos que conviene conocer.</p>
<h4 id="motores-de-almacenamiento">Motores de almacenamiento<a class="headerlink" href="#motores-de-almacenamiento" title="Permanent link">&para;</a></h4>
<p>En los SGBD, y en concreto en <em>MariaDB</em> y <em>PostgreSQL</em>, los motores de almacenamiento (<em>storage engines</em>) son fundamentales para definir el formato de almacenamiento, es decir, cómo se almacenan y gestionan los datos en las bases de datos. Tanto <em>MariaDB</em> como <em>PostgreSQL</em> ofrecen diferentes motores de almacenamiento que proporcionan distintas capacidades, los cuales influyen en cómo gestionan y organizan los datos en disco, afectando el rendimiento, la concurrencia y la eficiencia del espacio.</p>
<div class="grid cards">
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.157 4.412c-.676.284-.79.31-1.673.372-.65.045-.757.057-1.212.209-.75.246-1.395.75-2.02 1.59-.296.398-1.249 1.913-1.249 1.988 0 .057-.65.998-.915 1.32-.574.713-1.08 1.079-2.14 1.59-.77.36-1.224.524-4.102 1.477-1.073.353-2.133.738-2.367.864-.852.449-1.515 1.036-2.203 1.938-1.003 1.32-.972 1.313-3.042.947a12 12 0 0 0-.675-.063c-.644-.05-1.023.044-1.332.334L0 17.193l.177.088c.094.05.353.234.561.398.215.17.461.347.55.391.088.044.17.088.183.101s-.089.17-.228.353c-.435.581-.593.871-.574 1.048.019.164.032.17.43.17.517-.006.826-.056 1.261-.208.65-.233 2.058-.94 2.784-1.4.776-.5 1.717-.998 1.956-1.042.082-.02.354-.07.594-.114.58-.107 1.464-.095 2.587.05.108.013.373.045.6.064.227.025.43.057.454.076.026.012.474.037.998.056.934.026 1.104.007 1.3-.189.126-.133.385-.631.498-.985.209-.643.417-.921.366-.492-.113.966-.322 1.692-.713 2.411-.259.499-.663 1.092-.934 1.395-.322.347-.315.36.088.315.619-.063 1.471-.397 2.096-.82.827-.562 1.647-1.691 2.19-3.03.107-.27.22-.22.183.083-.013.094-.038.315-.057.498l-.031.328.353-.202c.833-.48 1.414-1.262 2.127-2.884.227-.518.877-2.922 1.073-3.976a10 10 0 0 1 .271-1.042c.127-.429.196-.555.48-.858.183-.19.625-.555.978-.808.72-.505.953-.75 1.187-1.205.208-.417.284-1.13.132-1.357-.132-.202-.284-.196-.763.006"/></svg></span> <strong><em>MariaDB</em></strong></p>
<p>Los motores más conocidos son:</p>
<ul>
<li>
<p><strong><em>InnoDB</em></strong>: motor de almacenamiento predeterminado en <em>MariaDB</em>, desde la versión 10.2. Proporciona soporte completo para transacciones ACID. Maneja bloqueo a nivel de fila y cuenta con soporte para claves ajenas. Finalmente, es adecuado para aplicaciones donde la integridad y las transacciones sean críticas.</p>
</li>
<li>
<p><strong><em>MyISAM</em></strong>: Históricamente, fue el motor de almacenamiento por defecto en <em>MySQL</em> antes de <em>InnoDB</em>. Su uso ha caído al no ser transaccional y no soportar claves ajenas. Se utiliza principalmente en aplicaciones que priorizan el rendimiento de las lecturas sobre la integridad de los datos.</p>
</li>
</ul>
<p>Existen otros motores más específicos como <em>TokuDB</em> (para grandes volúmenes de datos con alta concurrencia y compresión), <em>Aria</em> (utilizado para recuperación rápida y consultas de solo lectura), <em>ColumnStore</em> (en aplicaciones de análisis de datos) o <em>Memory</em> (para tablas temporales y cachés rápidas)</p>
</li>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.56 14.723a.5.5 0 0 0-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02 1.342-2.048 2.445-4.522 3.041-6.83.272-1.05.798-3.523.122-4.73a1.6 1.6 0 0 0-.15-.236C21.693.91 19.8.025 17.51.001c-1.495-.016-2.77.346-3.116.479a10 10 0 0 0-.516-.082 8 8 0 0 0-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79 4.729-.534 2.296 1.19.935 2.153.309 3.873.43 6.304c.041.818.507 3.334 1.243 5.744q.69 2.26 1.433 3.582.83 1.493 1.714 1.79c.448.148 1.133.143 1.858-.729a56 56 0 0 1 1.945-2.206c.435.235.906.362 1.39.377v.004a11 11 0 0 0-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6 0 0 0 .091.327c.227.423.922.61 1.015.633 1.335.333 2.505.092 3.372-.679-.017 2.231.077 4.418.345 5.088.221.553.762 1.904 2.47 1.904q.375.001.829-.094c1.782-.382 2.556-1.17 2.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136 0 0 .07-.048.427.03l.044.007.254.022.015.001c.847.039 1.911-.142 2.531-.43.644-.3 1.806-1.033 1.595-1.67M2.37 11.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683 1.562-4.493 1.837-1.299 4.84-.54 6.108-.13l-.01.01C6.795 3.734 6.843 7.226 6.85 7.44c0 .082.006.199.016.36.034.586.1 1.68-.074 2.918-.16 1.15.194 2.276.973 3.089q.12.126.252.237c-.347.371-1.1 1.193-1.903 2.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007 5.088a1.6 1.6 0 0 1-.432-.178c.089-.039.237-.09.483-.14 1.284-.265 1.482-.451 1.915-1 .099-.127.211-.27.367-.443a.4.4 0 0 0 .074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904 1.266-2.222 1.25-3.168 1.013m2.094-3.988-.052.14c-.133.357-.257.689-.334 1.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262 1.666-.996 2.643-.772.446.102.718.406.83.928.585 2.704.078 3.83-.33 4.736a9 9 0 0 0-.23.546m7.364 4.572q-.024.266-.062.596l-.146.438a.4.4 0 0 0-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18 1.057-.11 1.414-.878 2.227-2.417 2.556-1.515.325-1.784-.496-2.02-1.221a7 7 0 0 0-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4 0 0 0-.016-.113 2 2 0 0 0-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948 1.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6 6 0 0 0-.196.104c.092-1.106.439-3.174 1.736-4.482a4 4 0 0 1 .303-.276.35.35 0 0 0 .145-.064c.752-.57 1.695-.85 2.802-.833q.616.01 1.174.081c1.94.355 3.244 1.447 4.036 2.383.814.962 1.255 1.931 1.431 2.454-1.323-.134-2.223.127-2.68.78-.992 1.418.544 4.172 1.282 5.496.135.242.252.452.289.54.24.583.551.972.778 1.256.07.087.138.171.189.245-.4.116-1.12.383-1.055 1.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1 1 0 0 0 .134.103c.57.376 1.583.421 3.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105 1.001-.055.358-.112.728-.127 1.177-.014.436.04.89.093 1.33.107.887.216 1.8-.207 2.701a4 4 0 0 1-.188-.385 8 8 0 0 0-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543 1.342-.566 2.179-.463m.228 7.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6 0 0 0 .012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8 7.8 0 0 0-2.688-2.04A9.3 9.3 0 0 1 17.62.746c2.052.046 3.675.814 4.824 2.283a1 1 0 0 1 .067.1c.723 1.356-.276 6.275-2.987 10.54m-8.816-6.116c-.025.18-.31.423-.621.423a1 1 0 0 1-.081-.006.8.8 0 0 1-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22 0 0 1 .093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72 0 0 1-.408.223 1 1 0 0 1-.075.005c-.293 0-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185"/></svg></span> <strong><em>PostgreSQL</em></strong></p>
<p>En cambio, <em>PostgreSQL</em> no utiliza el concepto de múltiples motores de almacenamiento como <em>MariaDB</em>, sino que emplea un único motor nativo altamente configurable que ofrece muchas características avanzadas: </p>
<ul>
<li>Proporciona soporte completo para transacciones ACID, integridad referencial (claves foráneas) y MVCC para la gestión de concurrencia.</li>
<li>Bloqueo a nivel de fila.</li>
<li>Muy eficiente para grandes volúmenes de datos y con soporte completo para tipos de datos avanzados como JSON, XML, y más.</li>
</ul>
<p>Además, es posible ajustar su comportamiento, por ejemplo, permitiendo acceder a datos externos a través de FDW (<em>Foreign Data Wrappers</em>), y optimizaciones internas mediante tablas particionadas y configuraciones adicionales.</p>
</li>
</ul>
</div>
<div class="admonition info">
<p class="admonition-title">Bloqueo a nivel de fila (<em>row-level locking</em>)</p>
<p>Técnica de control de concurrencia que permite a las bases de datos bloquear únicamente las filas que están siendo accedidas o modificadas por una transacción, en lugar de bloquear toda la tabla o bloques más grandes de datos.</p>
<p>Permite que múltiples transacciones trabajen en diferentes partes de una tabla sin interferir entre sí.</p>
</div>
<div class="admonition info">
<p class="admonition-title">MVCC - <em>Multiversion Concurrency Control</em></p>
<p>Cuando hay una modificación de datos, en lugar de sobrescribir una fila en actualizaciones, se almacena una nueva versión de la fila mientras se mantiene la versión anterior hasta que ya no sea necesaria (las transacciones que la usan han finalizado).</p>
<p>Las versiones anteriores de una fila se almacenan en el espacio de "deshacer" (<em>undo space</em>) para permitir transacciones y lecturas consistentes.</p>
</div>
<h4 id="jerarquia-logica-de-una-bd">Jerarquía lógica de una BD<a class="headerlink" href="#jerarquia-logica-de-una-bd" title="Permanent link">&para;</a></h4>
<figure style="float: right;">
    <img src="images/05estructura-logica.png" width="425" title="Jerarquía lógica">
    <figcaption>Jerarquía lógica</figcaption>
</figure>

<p>A nivel lógico, los elementos que organizan la información de una base de datos se definen mediante la siguiente jerarquía:</p>
<ul>
<li><em>Tablespace</em> o espacio de tablas: estructura física (normalmente una carpeta/directorio) para agrupar varias bases de datos o esquemas.</li>
<li>Base de datos: elemento lógico de nivel superior</li>
<li>Esquema: agrupación lógica de una o más tablas (en <em>MySQL</em>/<em>MariaDB</em> un esquema es una base de datos).</li>
<li>Tabla: representación de una tabla relacional, que contiene datos organizados en filas y columnas. Cada tabla pertenece a un base de datos específica, y sus datos se almacenan en el <em>tablespace</em> asociado.</li>
<li>Fila: cada uno de los registros de la tabla</li>
</ul>
<p>En cuanto a los <em>tablespaces</em>, podemos crearlos mediante la instrucción <code>CREATE TABLESPACE</code> en <a href="https://www.postgresql.org/docs/current/sql-createtablespace.html">PostgreSQL</a> (en <em>MariaDB</em> <a href="https://mariadb.com/kb/en/create-tablespace/">no está soportado</a>), y a partir de él, crear bases de datos y tablas:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">mi_tablespace</span><span class="w"> </span><span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/ruta/al/directorio&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mi_db</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">mi_tablespace</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">mi_tabla</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="linenos" data-linenos="8 "></span><span class="p">)</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">mi_tablespace</span><span class="p">;</span>
</code></pre></div>
<p>En cambio, a nivel físico, el formato de almacenamiento depende principalmente del <em>motor de almacenamiento</em> que se esté utilizando, ya que cada motor tiene su propia manera de organizar y almacenar los datos.</p>
<div class="grid cards">
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.157 4.412c-.676.284-.79.31-1.673.372-.65.045-.757.057-1.212.209-.75.246-1.395.75-2.02 1.59-.296.398-1.249 1.913-1.249 1.988 0 .057-.65.998-.915 1.32-.574.713-1.08 1.079-2.14 1.59-.77.36-1.224.524-4.102 1.477-1.073.353-2.133.738-2.367.864-.852.449-1.515 1.036-2.203 1.938-1.003 1.32-.972 1.313-3.042.947a12 12 0 0 0-.675-.063c-.644-.05-1.023.044-1.332.334L0 17.193l.177.088c.094.05.353.234.561.398.215.17.461.347.55.391.088.044.17.088.183.101s-.089.17-.228.353c-.435.581-.593.871-.574 1.048.019.164.032.17.43.17.517-.006.826-.056 1.261-.208.65-.233 2.058-.94 2.784-1.4.776-.5 1.717-.998 1.956-1.042.082-.02.354-.07.594-.114.58-.107 1.464-.095 2.587.05.108.013.373.045.6.064.227.025.43.057.454.076.026.012.474.037.998.056.934.026 1.104.007 1.3-.189.126-.133.385-.631.498-.985.209-.643.417-.921.366-.492-.113.966-.322 1.692-.713 2.411-.259.499-.663 1.092-.934 1.395-.322.347-.315.36.088.315.619-.063 1.471-.397 2.096-.82.827-.562 1.647-1.691 2.19-3.03.107-.27.22-.22.183.083-.013.094-.038.315-.057.498l-.031.328.353-.202c.833-.48 1.414-1.262 2.127-2.884.227-.518.877-2.922 1.073-3.976a10 10 0 0 1 .271-1.042c.127-.429.196-.555.48-.858.183-.19.625-.555.978-.808.72-.505.953-.75 1.187-1.205.208-.417.284-1.13.132-1.357-.132-.202-.284-.196-.763.006"/></svg></span> <strong><em>MariaDB - InnoDB</em></strong></p>
<ul>
<li>
<p>Un bloque almacena los datos de tablas e índices mediante páginas (normalmente de 16 KB)</p>
</li>
<li>
<p>Los bloques se almacenan en un archivo de <ins>tablaspace</ins> (generalmente <code>ibdata1</code> para bases de datos que comparten un <em>tablespace</em>, o en un archivo por tabla).</p>
</li>
<li>
<p>Respecto a las filas, se almacenan utilizando un formato compacto o redondeado, dependiendo de la configuración. Cada fila contiene una clave primaria (o un índice que actúa como clave primaria) y los datos correspondientes.</p>
</li>
</ul>
</li>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.56 14.723a.5.5 0 0 0-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02 1.342-2.048 2.445-4.522 3.041-6.83.272-1.05.798-3.523.122-4.73a1.6 1.6 0 0 0-.15-.236C21.693.91 19.8.025 17.51.001c-1.495-.016-2.77.346-3.116.479a10 10 0 0 0-.516-.082 8 8 0 0 0-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79 4.729-.534 2.296 1.19.935 2.153.309 3.873.43 6.304c.041.818.507 3.334 1.243 5.744q.69 2.26 1.433 3.582.83 1.493 1.714 1.79c.448.148 1.133.143 1.858-.729a56 56 0 0 1 1.945-2.206c.435.235.906.362 1.39.377v.004a11 11 0 0 0-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6 0 0 0 .091.327c.227.423.922.61 1.015.633 1.335.333 2.505.092 3.372-.679-.017 2.231.077 4.418.345 5.088.221.553.762 1.904 2.47 1.904q.375.001.829-.094c1.782-.382 2.556-1.17 2.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136 0 0 .07-.048.427.03l.044.007.254.022.015.001c.847.039 1.911-.142 2.531-.43.644-.3 1.806-1.033 1.595-1.67M2.37 11.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683 1.562-4.493 1.837-1.299 4.84-.54 6.108-.13l-.01.01C6.795 3.734 6.843 7.226 6.85 7.44c0 .082.006.199.016.36.034.586.1 1.68-.074 2.918-.16 1.15.194 2.276.973 3.089q.12.126.252.237c-.347.371-1.1 1.193-1.903 2.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007 5.088a1.6 1.6 0 0 1-.432-.178c.089-.039.237-.09.483-.14 1.284-.265 1.482-.451 1.915-1 .099-.127.211-.27.367-.443a.4.4 0 0 0 .074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904 1.266-2.222 1.25-3.168 1.013m2.094-3.988-.052.14c-.133.357-.257.689-.334 1.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262 1.666-.996 2.643-.772.446.102.718.406.83.928.585 2.704.078 3.83-.33 4.736a9 9 0 0 0-.23.546m7.364 4.572q-.024.266-.062.596l-.146.438a.4.4 0 0 0-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18 1.057-.11 1.414-.878 2.227-2.417 2.556-1.515.325-1.784-.496-2.02-1.221a7 7 0 0 0-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4 0 0 0-.016-.113 2 2 0 0 0-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948 1.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6 6 0 0 0-.196.104c.092-1.106.439-3.174 1.736-4.482a4 4 0 0 1 .303-.276.35.35 0 0 0 .145-.064c.752-.57 1.695-.85 2.802-.833q.616.01 1.174.081c1.94.355 3.244 1.447 4.036 2.383.814.962 1.255 1.931 1.431 2.454-1.323-.134-2.223.127-2.68.78-.992 1.418.544 4.172 1.282 5.496.135.242.252.452.289.54.24.583.551.972.778 1.256.07.087.138.171.189.245-.4.116-1.12.383-1.055 1.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1 1 0 0 0 .134.103c.57.376 1.583.421 3.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105 1.001-.055.358-.112.728-.127 1.177-.014.436.04.89.093 1.33.107.887.216 1.8-.207 2.701a4 4 0 0 1-.188-.385 8 8 0 0 0-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543 1.342-.566 2.179-.463m.228 7.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6 0 0 0 .012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8 7.8 0 0 0-2.688-2.04A9.3 9.3 0 0 1 17.62.746c2.052.046 3.675.814 4.824 2.283a1 1 0 0 1 .067.1c.723 1.356-.276 6.275-2.987 10.54m-8.816-6.116c-.025.18-.31.423-.621.423a1 1 0 0 1-.081-.006.8.8 0 0 1-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22 0 0 1 .093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72 0 0 1-.408.223 1 1 0 0 1-.075.005c-.293 0-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185"/></svg></span> <strong><em>PostgreSQL</em></strong></p>
<ul>
<li>
<p>De manera predeterminada, todas las bases de datos utilizan el <em>tablespace</em> <code>pg_default</code>, pero se pueden crear otros <em>tablespaces</em> personalizados.</p>
</li>
<li>
<p>Cada base de datos se representa por un directorio con un nombre numérico (OID) dentro del <em>tablespace</em>. Dentro de esta carpeta se encuentran archivos que representan tablas, índices, secuencias y otros objetos de la base de datos.</p>
</li>
<li>
<p>Cada tabla se almacena en un archivo separado, y estos archivos están divididos en páginas de 8 KB. Si una tabla crece más allá de un tamaño específico (1 GB), se fragmenta en varios archivos con un sufijo numérico.</p>
</li>
<li>
<p>Las filas se organizan dentro de páginas de 8 KB, donde cada página contiene múltiples tuplas (filas). Cada fila o tupla en una tabla tiene un ctid (<em>tuple identifier</em>) que identifica su ubicación física en el archivo de datos.</p>
</li>
</ul>
</li>
</ul>
</div>
<h4 id="juegos-de-caracteres">Juegos de caracteres<a class="headerlink" href="#juegos-de-caracteres" title="Permanent link">&para;</a></h4>
<p>FIXME: Por otra parte, el parámetro opcional especificacion_create permite elegir el juego de caracteres que va a usar la base de datos (utf8, latin1, latin2, etc) y la colación, especifica cómo tratar el alfabeto del juego de caracteres, es decir, cómo se ordena (por ejemplo, la ñ después de de la n y no conforme a la tabla de códigos ascii) y cómo se comparan los caracteres (por ejemplo, si Á es igual que á).</p>
<p>Entendemos como <strong>juego de caracteres</strong> (<em>character sets</em>) a la codificación que utiliza el SGBD para representar los datos, definiendo qué caracteres pueden almacenarse en la base de datos y cómo esos caracteres son codificados internamente.</p>
<p>Tal como ya habéis estudiado en el módulo profesional de <em>Sistemas Informáticos</em>, los juegos de caracteres más conocidos son <code>ASCII</code> (caracteres básicos en inglés), <code>iso-8859-1 latin</code> (expande ASCII para incluir los caracteres acentuados y símbolos de los lenguajes occidentales) y <code>utf-8</code>, el cual parte de la familia de estándares <em>Unicode</em>, que puede representar caracteres de casi todos los lenguajes del mundo, incluidos caracteres <em>multibyte</em>.</p>
<p>Además, podemos configurar la <strong>colación</strong> (<em>collation</em>), la cual define cómo se comparan y ordenan las cadenas de texto para un juego de caracteres específico, teniendo en cuenta cosas como el uso de mayúsculas y minúsculas o el tratamiento de acentos</p>
<p>En <em>MariaDB</em> y <em>PostgreSQL</em>, los juegos de caracteres y las colaciones juegan un papel importante en cómo se almacenan y comparan las cadenas de texto. Cada sistema maneja los juegos de caracteres de manera diferente, y a continuación vamos a estudiar cómo funciona en cada uno:</p>
<div class="grid cards">
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.157 4.412c-.676.284-.79.31-1.673.372-.65.045-.757.057-1.212.209-.75.246-1.395.75-2.02 1.59-.296.398-1.249 1.913-1.249 1.988 0 .057-.65.998-.915 1.32-.574.713-1.08 1.079-2.14 1.59-.77.36-1.224.524-4.102 1.477-1.073.353-2.133.738-2.367.864-.852.449-1.515 1.036-2.203 1.938-1.003 1.32-.972 1.313-3.042.947a12 12 0 0 0-.675-.063c-.644-.05-1.023.044-1.332.334L0 17.193l.177.088c.094.05.353.234.561.398.215.17.461.347.55.391.088.044.17.088.183.101s-.089.17-.228.353c-.435.581-.593.871-.574 1.048.019.164.032.17.43.17.517-.006.826-.056 1.261-.208.65-.233 2.058-.94 2.784-1.4.776-.5 1.717-.998 1.956-1.042.082-.02.354-.07.594-.114.58-.107 1.464-.095 2.587.05.108.013.373.045.6.064.227.025.43.057.454.076.026.012.474.037.998.056.934.026 1.104.007 1.3-.189.126-.133.385-.631.498-.985.209-.643.417-.921.366-.492-.113.966-.322 1.692-.713 2.411-.259.499-.663 1.092-.934 1.395-.322.347-.315.36.088.315.619-.063 1.471-.397 2.096-.82.827-.562 1.647-1.691 2.19-3.03.107-.27.22-.22.183.083-.013.094-.038.315-.057.498l-.031.328.353-.202c.833-.48 1.414-1.262 2.127-2.884.227-.518.877-2.922 1.073-3.976a10 10 0 0 1 .271-1.042c.127-.429.196-.555.48-.858.183-.19.625-.555.978-.808.72-.505.953-.75 1.187-1.205.208-.417.284-1.13.132-1.357-.132-.202-.284-.196-.763.006"/></svg></span> <strong><em>MariaDB</em></strong></p>
<p>Admite múltiples juegos de caracteres y colaciones, que pueden establecerse a nivel de base de datos, tabla, columna o incluso a nivel de sesión.</p>
<p>Así pues, ofrece una gran flexibilidad con varios juegos de caracteres (como <code>utf8</code>, <code>utf8mb4</code>, <code>latin1</code>, etc.) y permite especificar colaciones para determinar cómo se comparan y ordenan los textos.</p>
</li>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.56 14.723a.5.5 0 0 0-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02 1.342-2.048 2.445-4.522 3.041-6.83.272-1.05.798-3.523.122-4.73a1.6 1.6 0 0 0-.15-.236C21.693.91 19.8.025 17.51.001c-1.495-.016-2.77.346-3.116.479a10 10 0 0 0-.516-.082 8 8 0 0 0-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79 4.729-.534 2.296 1.19.935 2.153.309 3.873.43 6.304c.041.818.507 3.334 1.243 5.744q.69 2.26 1.433 3.582.83 1.493 1.714 1.79c.448.148 1.133.143 1.858-.729a56 56 0 0 1 1.945-2.206c.435.235.906.362 1.39.377v.004a11 11 0 0 0-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6 0 0 0 .091.327c.227.423.922.61 1.015.633 1.335.333 2.505.092 3.372-.679-.017 2.231.077 4.418.345 5.088.221.553.762 1.904 2.47 1.904q.375.001.829-.094c1.782-.382 2.556-1.17 2.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136 0 0 .07-.048.427.03l.044.007.254.022.015.001c.847.039 1.911-.142 2.531-.43.644-.3 1.806-1.033 1.595-1.67M2.37 11.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683 1.562-4.493 1.837-1.299 4.84-.54 6.108-.13l-.01.01C6.795 3.734 6.843 7.226 6.85 7.44c0 .082.006.199.016.36.034.586.1 1.68-.074 2.918-.16 1.15.194 2.276.973 3.089q.12.126.252.237c-.347.371-1.1 1.193-1.903 2.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007 5.088a1.6 1.6 0 0 1-.432-.178c.089-.039.237-.09.483-.14 1.284-.265 1.482-.451 1.915-1 .099-.127.211-.27.367-.443a.4.4 0 0 0 .074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904 1.266-2.222 1.25-3.168 1.013m2.094-3.988-.052.14c-.133.357-.257.689-.334 1.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262 1.666-.996 2.643-.772.446.102.718.406.83.928.585 2.704.078 3.83-.33 4.736a9 9 0 0 0-.23.546m7.364 4.572q-.024.266-.062.596l-.146.438a.4.4 0 0 0-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18 1.057-.11 1.414-.878 2.227-2.417 2.556-1.515.325-1.784-.496-2.02-1.221a7 7 0 0 0-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4 0 0 0-.016-.113 2 2 0 0 0-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948 1.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6 6 0 0 0-.196.104c.092-1.106.439-3.174 1.736-4.482a4 4 0 0 1 .303-.276.35.35 0 0 0 .145-.064c.752-.57 1.695-.85 2.802-.833q.616.01 1.174.081c1.94.355 3.244 1.447 4.036 2.383.814.962 1.255 1.931 1.431 2.454-1.323-.134-2.223.127-2.68.78-.992 1.418.544 4.172 1.282 5.496.135.242.252.452.289.54.24.583.551.972.778 1.256.07.087.138.171.189.245-.4.116-1.12.383-1.055 1.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1 1 0 0 0 .134.103c.57.376 1.583.421 3.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105 1.001-.055.358-.112.728-.127 1.177-.014.436.04.89.093 1.33.107.887.216 1.8-.207 2.701a4 4 0 0 1-.188-.385 8 8 0 0 0-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543 1.342-.566 2.179-.463m.228 7.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6 0 0 0 .012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8 7.8 0 0 0-2.688-2.04A9.3 9.3 0 0 1 17.62.746c2.052.046 3.675.814 4.824 2.283a1 1 0 0 1 .067.1c.723 1.356-.276 6.275-2.987 10.54m-8.816-6.116c-.025.18-.31.423-.621.423a1 1 0 0 1-.081-.006.8.8 0 0 1-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22 0 0 1 .093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72 0 0 1-.408.223 1 1 0 0 1-.075.005c-.293 0-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185"/></svg></span> <strong><em>PostgreSQL</em></strong></p>
<p>Está optimizado principalmente para el uso de <code>utf8</code>, con menos enfoque en otros juegos de caracteres.</p>
<p>Las colaciones son más dependientes de las configuraciones del sistema operativo y se aplican al nivel de la base de datos o columna, pero la mayoría de los sistemas de producción usan <code>utf8</code> por su versatilidad.</p>
</li>
</ul>
</div>
<p>Del mismo modo, la configuración del juego de caracteres y la colación dependen del SGBD empleado:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">MariaDB</label><label for="__tabbed_6_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>La codificación y la colación se especifican al crear una base de datos mediante <a href="https://mariadb.com/kb/en/create-database/"><code>CREATE DATABASE</code></a> con las opciones <code>CHARACTER SET</code> y <code>COLLATE</code>.</p>
<p>Además de <code>utf8</code>, <code>latin1</code>y <code>ascii</code> ya comentados previamente, una codificación muy empleado es <strong><code>utf8mb4</code></strong>, la cual es una extensión de <code>utf8</code> que permite almacenar todos los caracteres de <em>Unicode</em>, incluidos emojis y otros símbolos que no se pueden representar en <code>utf8</code>.</p>
<p>Además, luego para cada juego de caracteres, tenemos sus colaciones. Por ejemplo, el juego de caracteres <code>utf8</code> tiene varias colaciones como:</p>
<ul>
<li><code>utf8_general_ci</code>: Colación insensible a mayúsculas/minúsculas (<em>case-insensitive</em>).</li>
<li><code>utf8_bin</code>: Colación binaria, sensible a mayúsculas/minúsculas y que compara los caracteres basándose en sus valores binarios.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mi_base_de_datos</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">utf8mb4</span>
<span class="linenos" data-linenos="3 "></span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8mb4_unicode_ci</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>La codificación y la colación se especifican al crear una base de datos mediante <a href="https://www.postgresql.org/docs/current/sql-createdatabase.html"><code>CREATE DATABASE</code></a> con las opciones <code>ENCODING</code> y <code>LC_COLLATE</code>.</p>
<p>Las colaciones más comunes son:</p>
<ul>
<li><code>en_US.UTF-8</code>: Colación en inglés, sensible a mayúsculas/minúsculas.</li>
<li><code>es_ES.UTF-8</code>: Colación en español.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mi_base_de_datos</span>
<span class="linenos" data-linenos="2 "></span><span class="k">WITH</span><span class="w"> </span><span class="k">ENCODING</span><span class="w"> </span><span class="s1">&#39;UTF8&#39;</span>
<span class="linenos" data-linenos="3 "></span><span class="n">LC_COLLATE</span><span class="w"> </span><span class="s1">&#39;es_ES.UTF-8&#39;</span>
<span class="linenos" data-linenos="4 "></span><span class="n">LC_CTYPE</span><span class="w"> </span><span class="s1">&#39;es_ES.UTF-8&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="tipos-de-datos">Tipos de datos<a class="headerlink" href="#tipos-de-datos" title="Permanent link">&para;</a></h3>
<p>Antes de entrar a ver cómo podemos crear las tablas, necesitamos conocer los tipos de datos que van a poder tener las columnas que definamos. <em>A grosso modo</em>, los tipos más empleados en <a href="https://mariadb.com/kb/en/data-types/">MariaDB</a> y <a href="https://www.postgresql.org/docs/current/datatype.html#DATATYPE-TABLE">PostgreSQL</a> son:</p>
<table>
<thead>
<tr>
<th>Tipo de dato</th>
<th><em>MariaDB</em></th>
<th><em>PostgreSQL</em></th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Numéricos</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>TINYINT</code></td>
<td>Sí</td>
<td>No</td>
<td>Entero pequeño, de 1 byte (<em>MariaDB</em>)</td>
</tr>
<tr>
<td><code>SMALLINT</code></td>
<td>Sí</td>
<td>Sí, alias <code>int2</code></td>
<td>Entero pequeño, de 2 bytes</td>
</tr>
<tr>
<td><code>MEDIUMINT</code></td>
<td>Sí</td>
<td>No</td>
<td>Entero de 3 bytes (<em>MariaDB</em>)</td>
</tr>
<tr>
<td><code>INT</code>, <code>INTEGER</code></td>
<td>Sí</td>
<td>Sí, alias <code>int4</code></td>
<td>Entero estándar de 4 bytes</td>
</tr>
<tr>
<td><code>BIGINT</code></td>
<td>Sí</td>
<td>Sí, alias <code>int8</code></td>
<td>Entero grande de 8 bytes</td>
</tr>
<tr>
<td><code>DECIMAL</code>, <code>NUMERIC</code></td>
<td>Sí</td>
<td>Sí</td>
<td>Número con precisión fija (exacta)</td>
</tr>
<tr>
<td><code>FLOAT</code></td>
<td>Sí</td>
<td>Sí</td>
<td>Número de coma flotante de precisión simple</td>
</tr>
<tr>
<td><code>DOUBLE</code></td>
<td>Sí</td>
<td>Sí, alias <code>float8</code></td>
<td>Número de coma flotante de precisión doble</td>
</tr>
<tr>
<td><code>SERIAL</code></td>
<td>No</td>
<td>Sí, alias <code>serial4</code></td>
<td>Entero autoincremental (<em>PostgreSQL</em>) <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></td>
</tr>
<tr>
<td><strong>Cadenas</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>CHAR(n)</code></td>
<td>Sí</td>
<td>Sí</td>
<td>Cadena de longitud fija</td>
</tr>
<tr>
<td><code>VARCHAR(n)</code></td>
<td>Sí</td>
<td>Sí</td>
<td>Cadena de longitud variable</td>
</tr>
<tr>
<td><code>TEXT</code></td>
<td>Sí</td>
<td>Sí</td>
<td>Cadena de longitud ilimitada</td>
</tr>
<tr>
<td><strong>Fechas y horas</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>DATE</code></td>
<td>Sí</td>
<td>Sí</td>
<td>Fecha (año, mes, día)</td>
</tr>
<tr>
<td><code>TIME</code></td>
<td>Sí</td>
<td>Sí</td>
<td>Hora (sin zona horaria)</td>
</tr>
<tr>
<td><code>DATETIME</code></td>
<td>Sí</td>
<td>No</td>
<td>Fecha y hora (<em>MariaDB</em>)</td>
</tr>
<tr>
<td><code>TIMESTAMP</code></td>
<td>Sí</td>
<td>Sí</td>
<td>Marca de tiempo (con o sin zona horaria)</td>
</tr>
<tr>
<td><strong>Booleanos</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>BOOLEAN</code></td>
<td>Sí (alias de <code>TINYINT</code>)</td>
<td>Sí, alias <code>bool</code></td>
<td>Tipo booleano (en <em>MariaDB</em> es alias de <code>TINYINT</code>)</td>
</tr>
</tbody>
</table>
<p>Algunos ejemplos de tipos serían:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">bigint</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">char</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="nb">decimal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">-- 5 dígitos en total, con 2 decimales, por ejemplo 123,45</span>
</code></pre></div>
<h4 id="creando-tipos-y-dominios">Creando tipos y dominios<a class="headerlink" href="#creando-tipos-y-dominios" title="Permanent link">&para;</a></h4>
<p>Además de todos los tipos de datos vistos (y algunos más que se salen del alcance del curso), en algunos SGBD (por ejemplo, <em>PostgreSQL</em> sí que lo permite, pero <em>MariaDB</em> no), podemos crear nuestros propios tipos de datos o dominios.</p>
<p>Mediante <code>CREATE TYPE</code> podemos definir tipos de datos complejos, como tipos de registros, arrays o tipos compuestos de varios atributos. Por ejemplo, podemos crear un tipo de dato para almacenar coordenadas:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="n">coordenada</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="nb">FLOAT</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="nb">FLOAT</span>
<span class="linenos" data-linenos="4 "></span><span class="p">);</span>
</code></pre></div>
<p>Por otro lado, mediante <code>CREATE DOMAIN</code> podemos definir un tipo de dato basado en un tipo existente, pero con restricciones adicionales (como validaciones, reglas de longitud, formatos, etc.). Por ejemplo, podemos crear un dominio para almacenar números naturales (enteros positivos):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DOMAIN</span><span class="w"> </span><span class="n">nnatural</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">VALUE</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</code></pre></div>
<h4 id="enumeraciones">Enumeraciones<a class="headerlink" href="#enumeraciones" title="Permanent link">&para;</a></h4>
<p>Además de los tipos vistos, podemos crear enumeraciones como un conjunto de valores restringidos que puede tomar un determinado campo, haciendo uso de la keyword <code>ENUM</code> tanto en <a href="https://mariadb.com/kb/en/enum/">MariaDB</a> como en <a href="https://www.postgresql.org/docs/16/datatype-enum.html">PostgreSQL</a>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">MariaDB</label><label for="__tabbed_7_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">curso</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="2 "></span><span class="n">horario</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;mañana&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;tarde&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;noche&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Primero debemos definir un tipo y luego asociar ese tipo al campo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="n">animo</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;feliz&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;triste&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;normal&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="n">estado</span><span class="w"> </span><span class="n">animo</span><span class="p">;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="tablas">Tablas<a class="headerlink" href="#tablas" title="Permanent link">&para;</a></h3>
<p>Dentro de la definición de datos, la creación de tablas es la parte más importante ya que nos permite trasladar nuestro modelo relacional al modelo físico.</p>
<p>Para crear una tabla emplearemos la sentencia <code>CREATE TABLE</code>. La sintaxis básica compartida por todos los SGBD es la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">basededatos</span><span class="p">.]</span><span class="n">nombreDeTabla</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">columna1</span><span class="w"> </span><span class="n">tipoDato1</span><span class="w"> </span><span class="p">[</span><span class="n">propiedadesColumna</span><span class="p">],</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="p">...</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">columnaN</span><span class="w"> </span><span class="n">tipoDatoN</span><span class="w"> </span><span class="p">[</span><span class="n">propiedadesColumna</span><span class="p">],</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="p">[</span><span class="n">restriccionesTabla</span><span class="p">]</span>
<span class="linenos" data-linenos="6 "></span><span class="p">);</span>
</code></pre></div>
<p>Conviene revisar la sintaxis de <a href="https://mariadb.com/kb/en/create-table/">MariaDB</a> y <a href="https://www.postgresql.org/docs/current/sql-createtable.html">PostgreSQL</a> para comprobar los detalles de cada SGBD.</p>
<p>Por ejemplo, para crear una tabla con un único atributo podríamos hacer:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">USUARIO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="p">);</span>
</code></pre></div>
<p>Algunas restricciones que hemos de tener en cuenta son:</p>
<ul>
<li>No puede haber nombres de tablas repetidas.</li>
<li>El nombre de la tabla debe comenzar por un carácter alfabético y su longitud máxima es de 30 caracteres. Sólo se permiten letras del alfabeto inglés, dígitos o el signo de guión bajo.</li>
<li>No podemos crear tablas cuyo nombre coincida con las palabras reservadas de SQL (por ejemplo, no podemos llamar a una tabla <code>WHERE</code>).</li>
<li>Como convención, vamos a nombrar las TABLAS en MAYÚSCULAS y las columnas en minúsculas.</li>
<li>En principio, respecto a los nombre de las tablas y las columnas, los SGBD no son <em>case sensitive</em> (no distinguen entre mayúsculas y minúsculas), aunque puede depender de la configuración del sistema operativo (sobre todo en sistemas Linux/Unix) o el uso de comillas dobles (no recomendado). En cambio, en los datos, depende de la configuración de la colación.   </li>
</ul>
<p>A continuación tenemos algunos ejemplos de creaciones de tablas con diferentes tipos de datos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PROVEEDOR</span><span class="p">(</span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">));</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CLIENTE</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">localidad</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;Elche&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PRESTAMO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="n">idPrestamo</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="n">fechaPrestamo</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">));</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CIUDAD</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="n">codigoPostal</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">03203</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PROVINCIA</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">5000</span><span class="p">);</span>
</code></pre></div>
<p>Con estos ejemplos, hemos visto que algunas de las propiedades de columna que podemos indicar son los valores no nulos (mediante <code>NOT NULL</code>) o valores por defecto (mediante <code>DEFAULT</code>). En el apartado <a href="#restricciones">Restricciones</a> las estudiaremos en profundidad.</p>
<h4 id="clave-primaria">Clave primaria<a class="headerlink" href="#clave-primaria" title="Permanent link">&para;</a></h4>
<p>Una vez visto como crear la tablas y sus atributos, nos centramos en la creación de la clave primaria. Toda tabla debe tener una clave primaria (ya sea simple o compuesta). Para ello, si tenemos un atributo simple, podemos añadir la propiedad <code>PRIMARY KEY</code> al atributo, aunque por convenciones de código, es mejor definir la clave primaria después de todos los atributos, a modo de restricciones. </p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CIUDAD</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w"> </span><span class="c1">-- clave primaria como propiedad</span>
</span><span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">5000</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PROVINCIA</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span>
<span class="hll"><span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nombre</span><span class="p">));</span><span class="w"> </span><span class="c1">-- clave primaria como restricción</span>
</span><span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="n">codigo</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="n">departamento</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">codigo</span><span class="p">,</span><span class="w"> </span><span class="n">departamento</span><span class="p">));</span><span class="w"> </span><span class="c1">-- clave primaria compuesta</span>
</span></code></pre></div>
Un buena práctica es definir un atributo a modo de <code>codigo</code> (o <code>id</code>) asociado a un número entero autoincrementable. Para ello, tras la definición del atributo como entero (sin signo), añadiremos la propiedad <code>AUTO_INCREMENT</code> en la definición del atributo.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PERSONA</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">UNSIGNED</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">fecha</span><span class="w"> </span><span class="nb">DATE</span><span class="p">);</span>
</code></pre></div>
<p>En <em>PostreSQL</em> existe el tipo <a href="https://www.postgresql.org/docs/current/datatype-numeric.html#DATATYPE-SERIAL"><code>serial</code></a> para crear una secuencia entera autoincrementable.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PERSONAP</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">fecha</span><span class="w"> </span><span class="nb">DATE</span><span class="p">);</span>
</code></pre></div>
<p>En <em>Oracle</em> (y en <em>PostgreSQL</em> también podemos hacerlo), se utilizan las secuencias en vez de los tipos autoincrementables. Tras cada inserción, la secuencia toma un nuevo valor.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="n">SEQUENCE</span><span class="w"> </span><span class="n">pid_seq</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PERSONAPS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;pid_seq&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="p">);</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Creando tablas con consultas</p>
<p>Un caso particular de la creación de tablas es hacerlo a partir del resultado de una consulta, de manera que contiene la estructura (tipos de datos) y los datos obtenido. Para ello, en vez de indicar los campos y restricciones, realizamos la consulta mediante <code>SELECT</code>: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">SELECT</span><span class="err">…</span>
</code></pre></div>
<p>Por ejemplo, para crear una tabla <code>GERENTE</code> con los datos de empleados catalogados como Gerentes, haríamos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">GERENTE</span><span class="w"> </span><span class="k">AS</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">apellido1</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">apellido2</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">email</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="n">e</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">puesto</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">&quot;%Gerente%&quot;</span><span class="p">;</span>
</code></pre></div>
<p>Volveremos a esta posibilidad cuando aprendamos a realizar consultas mediante SQL:</p>
</div>
<h4 id="modificando-tablas">Modificando tablas<a class="headerlink" href="#modificando-tablas" title="Permanent link">&para;</a></h4>
<p>Una vez creada una tabla, podemos modifica su estructura mediante las sentencias <strong><code>ALTER TABLE</code></strong>, tanto en <a href="https://mariadb.com/kb/en/alter-table/">MariaDB</a> como en <a href="https://www.postgresql.org/docs/current/sql-altertable.html">PostgreSQL</a>.</p>
<p>Para añadir columnas, usaremos la opción <strong><code>ADD</code></strong>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">nombreColumna</span><span class="w"> </span><span class="n">tipoDatos</span><span class="w"> </span><span class="p">[</span><span class="n">propiedades</span><span class="p">]</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="p">[,</span><span class="n">columnaSiguiente</span><span class="w"> </span><span class="n">tipoDatos</span><span class="w"> </span><span class="p">[</span><span class="n">propiedades</span><span class="p">]</span><span class="err">…</span><span class="p">)</span>
</code></pre></div>
<p>De este modo, si queremos añadir un campo para almacenar el teléfono de los empleados (sus campos estarán inicializados a <code>NULL</code> cada cada registro de la tabla <code>EMPLEADO</code>), haríamos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="p">(</span><span class="n">telefono</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">12</span><span class="p">));</span>
</code></pre></div>
<p>En cambio, si queremos eliminar una columna, usaremos la opción <code>DROP</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="p">(</span><span class="n">columna</span><span class="w"> </span><span class="p">[,</span><span class="n">columnaSiguiente</span><span class="p">,...]);</span>
</code></pre></div>
<p>Así pues, si queremos eliminar el teléfono recién creado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="p">(</span><span class="n">telefono</span><span class="p">);</span>
</code></pre></div>
<p>Finalmente, si queremos modifica el tipo de una columna, usaremos la opción <strong><code>MODIFY</code></strong>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">MODIFY</span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">columna</span><span class="w"> </span><span class="n">tipo</span><span class="w"> </span><span class="p">[</span><span class="n">propiedades</span><span class="p">]</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="p">[,</span><span class="n">columnaSiguiente</span><span class="w"> </span><span class="n">tipo</span><span class="w"> </span><span class="p">[</span><span class="n">propiedades</span><span class="p">]]</span>
</code></pre></div>
<p>Un caso particular de las operaciones de modificación es renombrar una tabla. Para ello, usaremos la opción <code>RENAME TO</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTablaViejo</span><span class="w"> </span><span class="k">RENAME</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">nombreNuevo</span><span class="p">;</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Autoevaluación</p>
<p>Si tenemos las siguientes tablas:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CLIENTE</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">dni</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">cnombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">direccion</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">60</span><span class="p">));</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="n">codigo</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="8 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="linenos" data-linenos="9 "></span><span class="w">    </span><span class="n">raza</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>
</code></pre></div>
<p>¿Sabes qué realizan las siguientes operaciones?</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">especie</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AFTER</span><span class="w"> </span><span class="n">raza</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">cliente</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">AFTER</span><span class="w"> </span><span class="n">nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">fk_duenyo</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">CLIENTE</span><span class="p">(</span><span class="n">dni</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">MODIFY</span><span class="w"> </span><span class="n">codigo</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">;</span>
</code></pre></div>
<p>Las siguientes instrucciones realizan la misma operación pero en diferente SGBD. ¿Sabes averiguar de quién es cada sentencia?</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">clientes</span><span class="w"> </span><span class="n">CHANGE</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="n">nomMascosta</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">clientes</span><span class="w"> </span><span class="k">RENAME</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">nomMascosta</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
</code></pre></div>
</div>
<h4 id="eliminando-tablas">Eliminando tablas<a class="headerlink" href="#eliminando-tablas" title="Permanent link">&para;</a></h4>
<p>Para eliminar tablas se emplea la instrucción <code>DROP TABLE nombreTabla</code>, tanto en <a href="https://mariadb.com/kb/en/drop-table/">MariaDB</a> como en <a href="https://www.postgresql.org/docs/current/sql-droptable.html">PostgreSQL</a>. Hemos de tener en cuenta que cuando tenemos un base de datos con tablas relacionadas mediante claves ajenas, la integridad referencial restringe el borrado de una clave primaria referenciada por una clave ajena. Es por ello que el orden importa, y tenemos que ir eliminando primero las tablas que contienen las claves ajenas y no son referenciadas por otras tablas.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CLIENTE</span><span class="p">;</span>
</code></pre></div>
<h3 id="restricciones">Restricciones<a class="headerlink" href="#restricciones" title="Permanent link">&para;</a></h3>
<p>Una vez hemos visto los casos más sencillos, hemos de saber que las tablas van a contener restricciones que aportan mayor integridad a los datos, en forma de claves ajenas, validaciones de campos, campos no nulos, únicos, etc... representando las restricciones estudiadas en el modelo relacional.</p>
<p>Así pues, si volvemos a la creación de tablas, y nos centramos en <em>MariaDB</em> podemos indicar las restricciones mediante diferentes parámetros:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="p">[</span><span class="k">TEMPORARY</span><span class="p">]</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">db</span><span class="p">.]</span><span class="n">tabla</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">campo1</span><span class="w"> </span><span class="n">tipo</span><span class="w"> </span><span class="p">[(</span><span class="n">tamaño</span><span class="p">)]</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">        </span><span class="p">[</span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="p">]</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="p">[</span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">valor</span><span class="p">]</span><span class="w"> </span><span class="c1">-- valor por defecto</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="p">[</span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">[</span><span class="k">KEY</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">]</span><span class="w"> </span><span class="c1">-- clave única o primaria</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="p">[</span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">tablaexterna</span><span class="w"> </span><span class="p">[(</span><span class="n">campoexterno1</span><span class="p">,</span><span class="w"> </span><span class="n">campoexterno2</span><span class="p">)]</span><span class="w"> </span><span class="c1">-- atributo clave ajena</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">            </span><span class="p">[</span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="err">{</span><span class="k">CASCADE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span><span class="err">}</span><span class="p">]</span><span class="w"> </span><span class="c1">-- propagación de borrados</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">            </span><span class="p">[</span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="err">{</span><span class="k">CASCADE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span><span class="err">}</span><span class="p">],</span><span class="w"> </span><span class="c1">-- propagación de actualizaciones</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">....,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">[</span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">múltiples</span><span class="w"> </span><span class="n">campos</span><span class="p">])</span><span class="w"> </span><span class="n">ENGINE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Innodb</span><span class="p">;</span><span class="w"> </span><span class="c1">-- motor de ejecución</span>
</code></pre></div>
<p>Las restricciones las podemos definir a nivel de opciones dentro de cada campo, o tras la definición de todos los campos, mediante la <em>keyword</em> <code>CONSTRAINT</code> tanto en <a href="https://mariadb.com/kb/en/constraint/">MariaDB</a> como en <a href="https://www.postgresql.org/docs/current/ddl-constraints.html">PostgreSQL</a>.</p>
<h4 id="claves-unicas">Claves únicas<a class="headerlink" href="#claves-unicas" title="Permanent link">&para;</a></h4>
<p>Cuando marcábamos en el modelo relación una propiedad como <code>UK</code>, es decir, clave única o alternativa, estamos indicando que dicho atributo no permite repetidos, y provocará la creación de un índice (los índices los estudiaremos en la unidad 9). Para ello, ahora usaremos la propiead <strong><code>UNIQUE</code></strong>.</p>
<p>Recuerda que las claves alternativas, normalmente, son una de las claves candidatas que no hemos elegido como clave primaria:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">dni</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="hll"><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nSegSocial</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
</span><span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">));</span>
</code></pre></div>
<p>La principal diferencia entre una clave primaria y una clave única es que la clave única permite valores nulos.</p>
<h4 id="claves-ajenas">Claves ajenas<a class="headerlink" href="#claves-ajenas" title="Permanent link">&para;</a></h4>
<p>Para indicar las claves ajena, aunque podemos hacerlo a nivel de campo, es mucho mejor acostrumbrarse a definirlas siempre como restricciones. Para ello, usaremos la siguiente estructura, donde <code>col</code> es el campo que apunta a la clave primaria <code>clave</code> de la tabla <code>tabla</code>. </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="p">(</span><span class="n">clave</span><span class="p">)</span>
</code></pre></div>
<p>A toda esta definición le pondremos un <code>nombre</code> por si más adelante necesitamos acceder a ella para modificarla, eliminarla, etc... Para definir este nombre, una convención es anteponer el tipo de restricción (<code>PK</code>, <code>FK</code>, <code>CK</code>, ...), y utilizando la barra de subrayado como separador, los nombres o siglas de los elementos involucrados.</p>
<p>Así pues, un ejemplo de tabla con clave primaria y claves ajenas definidas mediante <code>CONSTRAINT</code> sería:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ALQUILER</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">dni</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">codPelicula</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">UNSIGNED</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_ALQUILER</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dni</span><span class="p">,</span><span class="w"> </span><span class="n">codPelicula</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_ALQ_CLI</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dni</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">CLIENTE</span><span class="p">(</span><span class="n">dni</span><span class="p">),</span>
</span><span class="hll"><span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_ALQ_PEL</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">codPelicula</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">PELICULA</span><span class="p">(</span><span class="n">cod</span><span class="p">)</span>
</span><span class="linenos" data-linenos="7 "></span><span class="p">);</span>
</code></pre></div>
<p>Cuando tenemos una clave ajena compuesta, sólo hemos de indicar los atributos separándolos con comas:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EXISTENCIA</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">tipo</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">modelo</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">numAlmacen</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="n">cantidad</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_EXISTENCIAS</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">tipo</span><span class="p">,</span><span class="w"> </span><span class="n">modelo</span><span class="p">,</span><span class="w"> </span><span class="n">numAlmacen</span><span class="p">)</span>
<span class="hll"><span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_EXI_PIE</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">tipo</span><span class="p">,</span><span class="w"> </span><span class="n">modelo</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">PIEZA</span><span class="p">,</span>
</span><span class="linenos" data-linenos="8 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_EXI_ALM</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">numAlmacen</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">ALMACEN</span><span class="p">,</span>
<span class="linenos" data-linenos="9 "></span><span class="p">);</span>
</code></pre></div>
<h4 id="propagacion">Propagación<a class="headerlink" href="#propagacion" title="Permanent link">&para;</a></h4>
<p>Cuando se elimina (<code>ON DELETE</code>) o actualiza (<code>ON UPDATE</code>) un campo que está referenciado mediante una clave ajena, debemos indicar qué comportamiento de propagación debe realizar el SGBD con los datos en las tablas origen.</p>
<p>Vamos a retomar el ejemplo que vimos en la unidad 3, sobre un estudiante y las asignaturas que cursa, el cual se podría traducir en el siguiente DDL:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ESTUDIANTE</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">nif</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">codigo</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">fMatricula</span><span class="w"> </span><span class="nb">date</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="n">direccion</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">),</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_ESTUDIANTE</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nif</span><span class="p">)</span>
<span class="linenos" data-linenos=" 8 "></span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CURSAR</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="n">nifEstudiante</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="n">asignatura</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="n">anyo</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="n">repetidor</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_CURSAR</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">,</span><span class="w"> </span><span class="n">asignatura</span><span class="p">,</span><span class="w"> </span><span class="n">anyo</span><span class="p">),</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_CUR_EST</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">ESTUDIANTE</span><span class="p">(</span><span class="n">nif</span><span class="p">)</span>
<span class="linenos" data-linenos="17 "></span><span class="p">);</span>
</code></pre></div>
<p>Y un ejemplo de las tablas con datos sería:</p>
<ul>
<li>
<p><code>ESTUDIANTE</code></p>
<table>
<thead>
<tr>
<th><ins>nif</ins></th>
<th>codigo</th>
<th>nombre</th>
<th>fMatricula</th>
<th>direccion</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345678A</td>
<td>1</td>
<td>Pedro Casas</td>
<td>1/9/24</td>
<td>Avenida de la libertad, 23</td>
</tr>
<tr>
<td>48123456B</td>
<td>2</td>
<td>Mireia Vidal</td>
<td>1/9/24</td>
<td>Porta de la Morera, 6</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><code>CURSAR</code></p>
<table>
<thead>
<tr>
<th><ins>nifEstudiante</ins>*</th>
<th><ins>asignatura</ins></th>
<th><ins>anyo</ins></th>
<th>repetidor</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345678A</td>
<td>1</td>
<td>2024</td>
<td>true</td>
</tr>
<tr>
<td>48123456B</td>
<td>1</td>
<td>2024</td>
<td>false</td>
</tr>
<tr>
<td>12345678A</td>
<td>2</td>
<td>2023</td>
<td>false</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>¿Cómo repercute el sistema si eliminamos el estudiante <code>12345678A</code> de la tabla <code>ESTUDIANTE</code>? ¿O le cambiamos el <code>nif</code> (algo inusual, pero que puede pasar si nos hemos equivocado al teclearlo)? ¿Qué opciones tenemos para respetar la integridad referencial? </p>
<p>Las posibilidades son:</p>
<ul>
<li><code>NO ACTION</code>: se impide la operación, rechazando el borrado o la actualización. Este es el comportamiento por defecto si no indicamos nada.</li>
<li><code>CASCADE</code>: la operación se propaga de la tabla origen a la destino. Esto es, si borramos el estudiante, borrará los registros de <code>CURSAR</code>. Si modificamos su <code>nif</code>, también modificará los <code>nifEstudiante</code> de <code>CURSAR</code>.</li>
<li><code>SET NULL</code>: la clave ajena se pone a <code>NULL</code>, de manera que se pierde la relación existente, provocando probablemente incosistencia de datos.</li>
</ul>
<p>Si volvemos a definir la tabla CURSAR indicando las restricciones de propagación, podríamos hacer:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CURSAR</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">nifEstudiante</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">asignatura</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">anyo</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">repetidor</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_CURSAR</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">,</span><span class="w"> </span><span class="n">asignatura</span><span class="p">,</span><span class="w"> </span><span class="n">anyo</span><span class="p">),</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_CUR_EST</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">ESTUDIANTE</span><span class="p">(</span><span class="n">nif</span><span class="p">)</span>
<span class="hll"><span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
</span><span class="hll"><span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span>
</span><span class="linenos" data-linenos="10 "></span><span class="p">);</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Autoevaluación</p>
<p>¿Por qué en este caso concreto no podemos indicar la acción <code>SET NULL</code>?</p>
</div>
<p>FIXME: Continuar - Chapter 6 - pg250</p>
<h4 id="validaciones">Validaciones<a class="headerlink" href="#validaciones" title="Permanent link">&para;</a></h4>
<p>Para poder incluir restricciones de validación y que los datos introducidos cumplan ciertas validaciones, emplearemos el atributo <code>CHECK</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">INGRESO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">cod</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">concepto</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">importe</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">CK_INGRESO</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">importe</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">importe</span><span class="o">&lt;</span><span class="mi">8000</span><span class="p">));</span>
</span><span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">INGRESO2</span><span class="p">(</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="n">cod</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="n">concepto</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="n">importeMax</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="n">importe</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">CK_INGRESO</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">importe</span><span class="o">&lt;</span><span class="n">importeMax</span><span class="p">));</span>
</span></code></pre></div>
<h4 id="gestionando">Gestionando<a class="headerlink" href="#gestionando" title="Permanent link">&para;</a></h4>
<p>Además de indicar las restricciones mientras creamos una tabla, podemos hacerlo mediante sentencia <code>ALTER TABLE</code>.</p>
<p>Así pues, para añadir una nueva restricción usaremos la opción <code>ADD</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="p">[</span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">nombre</span><span class="p">]</span><span class="w"> </span><span class="n">tipoDeRestricción</span><span class="w"> </span><span class="p">(</span><span class="n">columnas</span><span class="p">);</span>
</code></pre></div>
<p>Para eliminar, la opción <code>DROP</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="err">{</span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">nombreRestricción</span><span class="err">}</span><span class="w"> </span><span class="p">[</span><span class="k">CASCADE</span><span class="p">]</span>
</code></pre></div>
<p>Respecto a las claves, si queremos deshabilitarlas para hacer algún tipo de modificación, haremos uso de las opciones <code>ENABLE</code> o <code>DISABLE</code> según convenga:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="n">KEYS</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="n">DISABLE</span><span class="w"> </span><span class="n">KEYS</span><span class="p">;</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Otros elementos</p>
<p>Existen otras estructuras que forman parte de DDL pero que veremos más adelante son:</p>
<ul>
<li><strong>Vistas</strong>: Permiten crear una representación externa (tabla virtual) a partir de una consulta, mediante <code>CREATE VIEW</code>. Las estudiaremos en la unidad 8.</li>
<li><strong>Índices</strong>: Se utilizan para acelerar las consultas, mediante <code>CREATE INDEX</code>. Los estudiaremos en la unidad 9.</li>
<li><strong>Disparadores</strong> (<em>triggers</em>): Se asocian a operaciones que se producen en el sistema (evento) para realizar otra acción. Los estudiaremos en la unidad 11.</li>
</ul>
</div>
<h2 id="cargando-datos">Cargando datos<a class="headerlink" href="#cargando-datos" title="Permanent link">&para;</a></h2>
<p>A la hora de cargar datos en una base de datos, además de las operaciones de inserción individual o múltiple de registros, todos los SGBD incorporan herramientas para la importación tanto de datos como recuperación de copias de seguridad que nos sirven para tener un entorno listo para trabajar.</p>
<h3 id="ejecutando-un-script">Ejecutando un script<a class="headerlink" href="#ejecutando-un-script" title="Permanent link">&para;</a></h3>
<p>Desde la línea de comandos...
Si prefieres la línea de comandos, puedes usar el cliente de MySQL para ejecutar sentencias SOURCE que carguen archivos SQL completos con datos predefinidos.</p>
<p>Ejemplo: Cargar un archivo SQL
bash
Copiar código
mysql -u usuario -p nombre_base_de_datos &lt; archivo.sql
Este método es ideal cuando tienes un archivo SQL con datos y estructura que quieres importar a tu base de datos.</p>
<h3 id="importando-una-base-de-datos">Importando una base de datos<a class="headerlink" href="#importando-una-base-de-datos" title="Permanent link">&para;</a></h3>
<div class="admonition exportando datos">
<p class="admonition-title">Exportando</p>
<p>Podemos crear un volcado de la base de datos mediante <code>mysqldump</code>::</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>mysqldump<span class="w"> </span>-u<span class="w"> </span>usuario<span class="w"> </span>-p<span class="w"> </span>nombre_base<span class="w"> </span>&gt;<span class="w"> </span>dump.sql
</code></pre></div>
</div>
<h3 id="cargando-datos-desde-archivos">Cargando datos desde archivos<a class="headerlink" href="#cargando-datos-desde-archivos" title="Permanent link">&para;</a></h3>
<p>Cada herramienta 
LOAD DATA INFILE
Esta es una opción eficiente para cargar grandes volúmenes de datos desde un archivo de texto (por ejemplo, CSV) en una tabla de MySQL. Es mucho más rápida que ejecutar múltiples sentencias INSERT.</p>
<p>Ejemplo: Cargar datos desde un archivo CSV
sql
Copiar código
LOAD DATA INFILE '/ruta/al/archivo.csv' 
INTO TABLE empleados
FIELDS TERMINATED BY ',' -- Separador de campos (coma)
LINES TERMINATED BY '\n'  -- Fin de línea
IGNORE 1 LINES            -- Ignora la primera línea (encabezados)
(nombre, puesto, salario); -- Especifica las columnas
Este método es muy útil cuando se necesita importar grandes cantidades de datos de forma rápida y eficiente. Algunas bases de datos restringen el uso de LOAD DATA INFILE por razones de seguridad, por lo que es posible que necesites habilitar esta función en el servidor o ajustar permisos.</p>
<h2 id="dml">DML<a class="headerlink" href="#dml" title="Permanent link">&para;</a></h2>
<p>Sobre una tabla, las operaciones que vamos a poder realizar son:</p>
<ul>
<li>insertar datos en una tabla</li>
<li>modificar datos de una tabla</li>
<li>eliminar datos de una tabla</li>
</ul>
<p>Cuando hablamos de "datos de una tabla", podemos referirnos a registros completos, campos concretos o incluso elementos relacionados de varias tablas.</p>
<p>Para realizar estas operaciones, se utiliza el subconjunto DML (<em>Data Manipulation Language</em>) de SQL.</p>
<h3 id="modificaciones">Modificaciones<a class="headerlink" href="#modificaciones" title="Permanent link">&para;</a></h3>
<p>La sintaxis es:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">campo</span><span class="o">=</span><span class="n">valor</span><span class="p">;</span>
</code></pre></div>
<h4 id="filtrando">Filtrando<a class="headerlink" href="#filtrando" title="Permanent link">&para;</a></h4>
<p>Si queremos decidir qué elementos modificar, añadimos la expresión <code>WHERE</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">campo</span><span class="o">=</span><span class="n">valor</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">condicion</span><span class="p">;</span>
</code></pre></div>
<h3 id="inserciones">Inserciones<a class="headerlink" href="#inserciones" title="Permanent link">&para;</a></h3>
<p>La sintaxis es:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">valor1</span><span class="p">,</span><span class="w"> </span><span class="n">valor2</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</code></pre></div>
<h3 id="borrados">Borrados<a class="headerlink" href="#borrados" title="Permanent link">&para;</a></h3>
<p>La sintaxis es:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DELETE</span><span class="w"> </span><span class="n">campo</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tabla</span><span class="p">;</span>
</code></pre></div>
<h4 id="filtrando_1">Filtrando<a class="headerlink" href="#filtrando_1" title="Permanent link">&para;</a></h4>
<p>Si queremos decidir qué elementos eliminar, del mismo modo que en las modificaciones, añadimos la expresión <code>WHERE</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DELETE</span><span class="w"> </span><span class="n">campo</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">condicion</span><span class="p">;</span>
</code></pre></div>
<h3 id="anomalias">Anomalías<a class="headerlink" href="#anomalias" title="Permanent link">&para;</a></h3>
<h2 id="reto-ii-creamos">Reto II - Creamos<a class="headerlink" href="#reto-ii-creamos" title="Permanent link">&para;</a></h2>
<p>En el reto anterior diseñamos una base de datos. En este reto nos vamos a centrar en la creación del modelo físico, creando y cargando datos, para posteriormente definir una serie de informes y KPIs que generaremos mediante consultas utilizando SQL.</p>
<div class="admonition info">
<p class="admonition-title">KPI</p>
<p>Un KPI () es un ...</p>
</div>
<h2 id="referencias">Referencias<a class="headerlink" href="#referencias" title="Permanent link">&para;</a></h2>
<!--
https://jorgesanchez.net/manuales/sql/intro-sql-sql2016.html
-->

<ul>
<li>
<p>Sintaxis SQL oficial de <a href="https://www.postgresql.org/docs/current/sql-commands.html">PostgreSQL</a> y <a href="https://mariadb.com/kb/en/sql-statements/">MariaDB</a>.</p>
</li>
<li>
<p>Materiales sobre el módulo de BD:</p>
<ul>
<li><em><a href="https://ioc.xtec.cat/materials/FP/Recursos/fp_dam_m02_/web/fp_dam_m02_htmlindex/WebContent/u5/a2/continguts.html">DDL</a> y <a href="https://ioc.xtec.cat/materials/FP/Recursos/fp_dam_m02_/web/fp_dam_m02_htmlindex/WebContent/u5/a1/continguts.html">DML</a> - Institut Obert de Catalunya</em></li>
<li><a href="https://josejuansanchez.org/bd/unidad-04-teoria/index.html">Creación de bases de datos en MySQL</a> de <em>José Juan Sánchez</em></li>
<li><a href="https://jorgesanchez.net/manuales/sql/intro-sql-sql2016.html">Introducción a SQL</a>, <a href="https://jorgesanchez.net/manuales/sql/ddl-tablas-sql2016.html">DDL</a> y <a href="https://jorgesanchez.net/manuales/sql/dml-sql2016.html">DML</a> de <em>Jorge Sánchez</em></li>
<li><a href="https://apuntes-daw.javiergutierrez.trade/bases-de-datos/ut5/recopila.html">Tratamiento de datos</a> de <em>Javier Gutiérrez</em></li>
<li><a href="https://gestionbasesdatos.readthedocs.io/es/latest/Tema3/index.html">Diseño físico de bases de datos - DDL</a>  y <a href="https://gestionbasesdatos.readthedocs.io/es/latest/Tema5/index.html">Modificación de bases de datos - DML</a> de gestionbasesdatos.readthedocs.io</li>
<li><a href="https://www.cs.us.es/cursos/bd-2023/temas/BD-Tema-5.pdf">Introducción a SQL</a>, por <em>Luis Valencia</em> y <em>David Orellana</em>, de la <em>Universidad de Sevilla</em>.</li>
</ul>
</li>
</ul>
<h2 id="actividades">Actividades<a class="headerlink" href="#actividades" title="Permanent link">&para;</a></h2>
<p><a name="AC501"></a></p>
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z"/></svg></span> <strong>AC501</strong>. (<abbr title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr> // <abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr> // 3p) En <em>MariaDB</em>, descarga la base de datos <a href="resources/world.sql.zip">world.sql.zip</a>, y tras descomprimirla y cárgala mediante <em>PhpMyAdmin</em>. A continuación, averigua:</p>
<ul>
<li>¿Cuántas tablas tiene?</li>
<li>¿Cuántos y de qué tipos son los campos de la tabla <code>city</code>?</li>
<li>¿Cuál es el formato de almacenamiento de la base de datos? ¿Qué motor de almacenamiento emplea?</li>
</ul>
</li>
</ul>
<p><a name="AP502"></a></p>
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 3c3.88 0 7 3.14 7 7 0 2.8-1.63 5.19-4 6.31V21H9v-3H8c-1.11 0-2-.89-2-2v-3H4.5c-.42 0-.66-.5-.42-.81L6 9.66A7.003 7.003 0 0 1 13 3m-2.68 4.39h1.93c.01-.3.1-.53.28-.69a1 1 0 0 1 .66-.23c.31 0 .57.1.75.28.18.19.26.45.26.75 0 .32-.07.59-.23.82-.14.23-.35.43-.61.59-.51.34-.86.64-1.05.91-.2.26-.31.68-.31 1.18h2c0-.31.04-.56.13-.74.09-.19.26-.36.51-.52.45-.24.82-.53 1.11-.93s.44-.81.44-1.31c0-.76-.27-1.37-.81-1.82-.53-.45-1.26-.68-2.19-.68-.87 0-1.57.2-2.11.59-.52.41-.78.98-.77 1.77zM12 14h2v-2h-2zm1-13C8.41 1 4.61 4.42 4.06 8.9L2.5 11h-.03l-.02.03c-.55.76-.62 1.76-.19 2.59.36.69 1 1.17 1.74 1.32V16c0 1.85 1.28 3.42 3 3.87V23h11v-5.5c2.5-1.67 4-4.44 4-7.5 0-4.97-4.04-9-9-9"/></svg></span> <strong>AP502</strong>. (<abbr title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr> // <abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr> // 3p) En <em>PostgreSQL</em>, mediante SQL, crea una base de datos con un <em>tablespace</em> definido previamente y el juego de caracteres que permita el uso de emojis y que no sea <em>case sensitive</em>.</p>
<p>En dicha tabla, crea una tabla cuya clave sea un valor autonumérico y tenga un atributo que permita introducir cadenas de texto.</p>
<p>A continuación, mediante <em>PgAdmin</em>, obtén la información tanto de la base de datos como de la tabla, e inserta una frase que contenga algún emoji. Comprueba que la información se ha almacenado correctamente.</p>
<p>Debes entregar en Aules:</p>
<ul>
<li>Comandos SQL empleados.</li>
<li>Capturas de pantalla de <em>PgAdmin</em> con la información solicitada.</li>
</ul>
</li>
</ul>
<p><a name="AC503"></a></p>
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z"/></svg></span> <strong>AC503</strong>. (<abbr title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr> // <abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr title="Se han definido los campos clave en las tablas.">CE2d</abbr> // 3p) Crea el siguiente modelo relacional en <em>MariaDB</em> y en <em>PostreSQL</em>, y adjunta tanto las instrucciones DDL como capturas de pantalla con la estructura de las tablas:</p>
<ul>
<li>
<p>Tabla <code>FABRICANTE</code></p>
<ul>
<li>Campos:<ul>
<li><code>codFabricante</code>: entero autoincrementable</li>
<li><code>nombre</code>: cadena 32</li>
<li><code>pais</code>: cadena 32</li>
</ul>
</li>
<li>Restricciones:<ul>
<li>La clave primaria es <code>codFabricante</code></li>
<li>El <code>nombre</code> no puede ser nulo</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Tabla <code>ARTICULO</code></p>
<ul>
<li>Campos:<ul>
<li><code>codigo</code>: cadena 32</li>
<li><code>codFabricante</code>: entero</li>
<li><code>peso</code>: numérico con dos decimales</li>
<li><code>categoria</code>: cadena 16</li>
<li><code>precioVenta</code>: numérico con dos decimales</li>
<li><code>precioCompra</code>: numérico con dos decimales</li>
<li><code>existencias</code>: entero sin signo</li>
</ul>
</li>
<li>Restricciones:<ul>
<li>La clave primaria es: <code>codigo</code>, <code>codFabricante</code>, <code>peso</code>, <code>categoría</code>.</li>
<li>La <code>categoria</code> ha de ser <code>primera</code>, <code>segunda</code> o <code>tercera</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol>
<li>Modifica el atributo <code>pais</code> de la tabla <code>FABRICANTE</code> para que el valor por defecto sea <code>España</code>.</li>
<li>Añade una columna antes de <code>pais</code> en la tabla <code>FABRICANTE</code> para guardar la <code>provincia</code>.</li>
<li>Renombra la tabla <code>ARTICULO</code> a <code>PRODUCTO</code>.</li>
</ol>
</li>
</ul>
<p><a name="AC504"></a></p>
<!-- Restricciones -->
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z"/></svg></span> <strong>AC504</strong>. (<abbr title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr> // <abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr> // 3p) A partir del ejercicio <a href="#AC503">AC503</a>, vuelve a indicar la instrucciones <code>CREATE TABLE</code> de la tabla <code>ARTICULO</code> de manera que:</p>
<ul>
<li><code>codFabricante</code> sea una clave ajena que apunta a <code>FABRICANTE</code>.</li>
<li>al eliminar un fabricante concreto, si hay artículos de dicho fabricante, se deben prohibir la operación. En cambio, si modificamos el código de la tabla <code>FABRICANTE</code>, la clave ajena también cambiará su valor.</li>
<li>los atributos <code>precioVenta</code> y <code>precioCompra</code> deben de ser mayores de 0.</li>
</ul>
<p>A continuación, mediante operaciones <code>ALTER TABLE</code> añade las siguientes restricciones:</p>
<ul>
<li>La columna <code>ARTICULO.fabricante</code> no puede adminitir valores nulos.</li>
<li>El <code>peso</code> debe ser superior o igual a 1.00.</li>
</ul>
</li>
</ul>
<p><a name="AR505"></a></p>
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 3c3.88 0 7 3.14 7 7 0 2.8-1.63 5.19-4 6.31V21H9v-3H8c-1.11 0-2-.89-2-2v-3H4.5c-.42 0-.66-.5-.42-.81L6 9.66A7.003 7.003 0 0 1 13 3m-2.68 4.39h1.93c.01-.3.1-.53.28-.69a1 1 0 0 1 .66-.23c.31 0 .57.1.75.28.18.19.26.45.26.75 0 .32-.07.59-.23.82-.14.23-.35.43-.61.59-.51.34-.86.64-1.05.91-.2.26-.31.68-.31 1.18h2c0-.31.04-.56.13-.74.09-.19.26-.36.51-.52.45-.24.82-.53 1.11-.93s.44-.81.44-1.31c0-.76-.27-1.37-.81-1.82-.53-.45-1.26-.68-2.19-.68-.87 0-1.57.2-2.11.59-.52.41-.78.98-.77 1.77zM12 14h2v-2h-2zm1-13C8.41 1 4.61 4.42 4.06 8.9L2.5 11h-.03l-.02.03c-.55.76-.62 1.76-.19 2.59.36.69 1 1.17 1.74 1.32V16c0 1.85 1.28 3.42 3 3.87V23h11v-5.5c2.5-1.67 4-4.44 4-7.5 0-4.97-4.04-9-9-9"/></svg></span> <strong>AR505</strong>. (<abbr title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr> // <abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr> // 3p) Mediante <em>MariaDB</em> o <em>PostgreSQL</em>, crea las tablas necesarias para representar que un empleado tiene diferentes números de teléfono que queremos almacenar, teniendo en cuenta que:</p>
<ul>
<li>Los teléfonos se presentan mediante un prefijo de tres caracteres y número de 9 digitos.</li>
<li>Si eliminamos a un empleado, también eliminaremos todos sus teléfonos.</li>
</ul>
<p>Para ello, haciendo uso de la herramienta gráfica apropiada, inserta datos (varios empleados y varios teléfonos para cada empleado) y posteriormente prueba a eliminar un empleado.</p>
<p>Adjunta tanto los scripts DDL como capturas de las tablas antes y después de realizar la operación de borrado.</p>
</li>
</ul>
<p><a name="AC506"></a></p>
<ul>
<li>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z"/></svg></span> <strong>AC506</strong>. (<abbr title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr> // <abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr title="Se han definido los campos clave en las tablas.">CE2d</abbr> // 3p) Crea el siguiente modelo relacional en <em>MariaDB</em> y en <em>PostreSQL</em>:</p>
<p><code>
<strong>DEPARTAMENTO</strong> (<ins>codD</ins>, nombre, direcc)<br />
· PK: (codD)<br />
· VNN: (nombre)
</code></p>
<p><code>
<strong>EMPLEADO</strong> (<ins>dni</ins>, nombrec, salario, direcc, departamento<code>*</code>)<br />
· PK: (dni)<br />
· UK: (nombrec)<br />
· VNN: (nombrec)<br />
· VNN: (salario)<br />
· VNN: (departamento)<br />
· FK: (departamento) → DEPARTAMENTO 
</code></p>
<p>Además, el salario de cada empleado debe ser igual o superior a 900, y su valor por defecto es de 1000.</p>
<p>A continuación, mediante haciendo uso de <code>ALTER TABLE</code>:</p>
<ul>
<li>Elimina la clave ajena de la tabla <code>EMPLEADO</code>.</li>
<li>Vuelve a añadir la clave ajena</li>
</ul>
<p>Finalmente, elimina las las tablas creadas.</p>
</li>
</ul>
<p><a name="AP507"></a></p>
<ul>
<li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m15.1 1.81-2.83 2.83c-.77.78-.77 2.05 0 2.83l1.41 1.41-4.55 4.55-2.82-2.83L4.89 12c-4.95 5-1.39 8.5-1.39 8.5S7 24 12 19.09l1.41-1.41-2.8-2.8 4.54-4.54 1.39 1.39c.78.77 2.05.77 2.83 0L22.2 8.9zm2.83 8.47L16.55 8.9l-1.44-1.44-1.4-1.4 1.41-1.41 4.23 4.23z"/></svg></span> <strong>AP507</strong>. (<abbr title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr> // <abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr>  // 3p) A partir de la actividad <a href="04mr-eer.html#AC407">AC407</a> (que a su vez se basa en la <a href="02er.html#AC203">AC203</a>), crea las instrucciones DDL necesarias para crear el modelo físico.</li>
</ul>
<!--

=== "MariaDB"

    Más información en la [documentación oficial](https://mariadb.com/kb/en/drop-database/)

=== "PostgreSQL"

    Más información en la [documentación oficial](https://www.postgresql.org/docs/current/sql-dropdatabase.html)

-->

<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>en MariaDB se hace con la cláusula <code>AUTO_INCREMENT</code>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  



  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        <a href='https://ko-fi.com/T6T8GWT9N' title='Invítame a un café en ko-fi.com' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi2.png?v=3' border='0' alt='Invítame a un café en ko-fi.com' /></a>
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="Me encantan estos apuntes" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="Los apuntes son mejorables" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Gracias por tu tiempo. Si quieres me puedes <a href='https://ko-fi.com/T6T8GWT9N'>invitar a un café en ko-fi</a>.
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              ¡Gracias por tu colaboración! Ayúdame a mejorar los apuntes enviándome un mail a <a href="mailto:a.medrano@edu.gva.es">a.medrano@edu.gva.es</a> con tus comentarios.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2024-2025 Aitor Medrano - <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.es">Licencia CC BY-NC-SA</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://aitor-medrano.github.io/" target="_blank" rel="noopener" title="aitor-medrano.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2s.06-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.92 7.92 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8 8 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.7 15.7 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/aitormedrano" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<a.medrano@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  




  


<h4>Consentimiento de cookie</h4>
<p>Esta página de apuntes utiliza cookies para reconocer las visitas, medir la efectividad de la documentación y averiguar si encuentras aquello que buscas o cómo has llegado a estos apuntes. Con tu consentimiento, me ayudas a mejorar estos materiales.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Aceptar</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Gestionar cookies</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "navigation.top", "navigation.tracking", "navigation.footer", "navigation.indexes", "content.code.annotate", "announce.dismiss", "toc.follow", "content.code.copy"], "search": "assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>